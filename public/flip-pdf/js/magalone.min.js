/*!

exHelp Library - Extensible Helper // Version 1.1.0.0
http://www.github.com/xwcg

The MIT License (MIT)

Copyright (c) 2014 Michael Schwarz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
!function(e){var t={_storage:{},_subscribers:{},settings:{},info:{AppName:"Extensible Helper Class",Version:"1.1.0.0",Author:"Michael Schwarz"},addStorage:function(e){return void 0===this._storage[e]&&(this._storage[e]={}),this.getStorage(e)},getStorage:function(e){return this._storage[e]},storage:function(e){return this._storage[e]?this._storage[e]:this.addStorage(e)},subscribe:function(e,t){this._subscribers[e]?this._subscribers[e].push(t):(this._subscribers[e]=[],this.subscribe(e,t))},unsubscribe:function(e,t){if(this._subscribers[e])for(var r=0;r<this._subscribers[e].length;r++)if(this._subscribers[e][r]===t){this._subscribers[e].splice(r,1);break}},clearSubscriptions:function(e){this._subscribers[e]&&(this._subscribers[e]=[])},_trigger:function(t,r){if(this._subscribers[t])for(var n=this._subscribers[t],a=0;a<n.length;a++){n[a].apply(e,r)}},trigger:function(e,t,r,n){var a=this;n?(this._trigger(e,t),r&&this.clearSubscriptions(e)):this.defer((function(){a._trigger(e,t),r&&a.clearSubscriptions(e)}))},defer:function(e,t,r,n){this.is.function(e)&&setTimeout((function(){t?e.apply(t,r):r?e.apply(void 0,r):e()}),n||1)},extend:function(e,t){for(var r in t||(t=e,e=this),t)void 0!==t[r]&&(e[r]=t[r])},each:function(e,t,r){if(void 0!==e.length){var n=0,a=e.length;if(r)for(;n<a&&!1!==t.apply(e[n],r);n++);else for(;n<a&&!1!==t.call(e[n],n,e[n]);n++);}return e},jsonParse:function(e){try{return JSON.parse(e)}catch(t){return console.error("JSON Parse Error ",t,"While Parsing: '",e,"'"),null}},jsonStringify:function(e){try{return JSON.stringify(e)}catch(e){return console.error("JSON Stringify Error ",e,"While Stringifying: ",e),null}},random:{
//! Internal random string function (letters AND numbers!)
_gen:function(e){for(var t=e.upper||65,r=e.lower||90,n=e.len||e.length||8,a="";a.length<n;)100*Math.random()>=50?a+=String.fromCharCode(Math.floor(Math.random()*(t-r)+r)):a+=Math.floor(9*Math.random()).toString();return a},number:function(e,t){return Math.random()*(t-e)+e},string:function(e,t){var r=65,n=90;return void 0!==t&&!1===t&&(r=97,n=122),this._gen({upper:n,lower:r,len:e})},hex:function(e){return this._gen({upper:102,lower:97,len:e})},guid:function(){return"{0}-{1}-{2}-{3}-{4}".format(this.hex(8),this.hex(4),this.hex(4),this.hex(4),this.hex(12))},hexColor:function(){return"#"+this.hex(6)},date:function(e,r){if(!t.date)return console.error("exHelp: Date Extension not found!");var n=t.date.fix(r).getTime(),a=t.date.fix(e).getTime();return t.date.fix(Math.random()*(n-a)+a)}},array:{clone:function(e){return t.jsonParse(t.jsonStringify(e))},sieve:function(e){var r=function(e){for(var n in e){var a=e[n];if(t.isString(a)){if(e[n]=a=a.trim(),0==a.trim().length)return e.splice(n,1),r(e)}else if(null==a)return e.splice(n,1),r(e)}return e};return r(e)},contains:function(e,t){return-1!==e.indexOf(t)}},math:{rect:function(e,t,r,n){return{top:e||0,left:t||0,right:n||0,bottom:r||0,get width(){return this.right-this.left},get height(){return this.bottom-this.top},set width(e){this.right=this.left+e},set height(e){this.bottom=this.top+e},moveTopBy:function(e){this.top+=e,this.bottom+=e},moveTopTo:function(e){var t=this.height;this.top=e,this.bottom=this.top+t},moveLeftBy:function(e){this.left+=e,this.right+=e},moveLeftTo:function(e){var t=this.width;this.left=e,this.right=this.left+t},intersects:function(e){return this.left<=e.right&&e.left<=this.right&&this.top<=e.bottom&&e.top<=this.bottom},contains:function(e){return e.left<=this.right&&e.left>=this.left&&e.top<=this.bottom&&e.top>=this.top&&e.right<=this.right&&e.right>=this.left&&e.bottom<=this.bottom&&e.bottom>=this.top}}},easing:{linearTween:function(e,t,r,n){return r*e/n+t},easeInQuad:function(e,t,r,n){return r*(e/=n)*e+t},easeOutQuad:function(e,t,r,n){return-r*(e/=n)*(e-2)+t},easeInOutQuad:function(e,t,r,n){return(e/=n/2)<1?r/2*e*e+t:-r/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,r,n){return r*(e/=n)*e*e+t},easeOutCubic:function(e,t,r,n){return e/=n,r*(--e*e*e+1)+t},easeInOutCubic:function(e,t,r,n){return(e/=n/2)<1?r/2*e*e*e+t:r/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,r,n){return r*(e/=n)*e*e*e+t},easeOutQuart:function(e,t,r,n){return e/=n,-r*(--e*e*e*e-1)+t},easeInOutQuart:function(e,t,r,n){return(e/=n/2)<1?r/2*e*e*e*e+t:-r/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,r,n){return r*(e/=n)*e*e*e*e+t},easeOutQuint:function(e,t,r,n){return e/=n,r*(--e*e*e*e*e+1)+t},easeInOutQuint:function(e,t,r,n){return(e/=n/2)<1?r/2*e*e*e*e*e+t:r/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,r,n){return-r*Math.cos(e/n*(Math.PI/2))+r+t},easeOutSine:function(e,t,r,n){return r*Math.sin(e/n*(Math.PI/2))+t},easeInOutSine:function(e,t,r,n){return-r/2*(Math.cos(Math.PI*e/n)-1)+t},easeInExpo:function(e,t,r,n){return r*Math.pow(2,10*(e/n-1))+t},easeOutExpo:function(e,t,r,n){return r*(1-Math.pow(2,-10*e/n))+t},easeInOutExpo:function(e,t,r,n){return(e/=n/2)<1?r/2*Math.pow(2,10*(e-1))+t:(e--,r/2*(2-Math.pow(2,-10*e))+t)},easeInCirc:function(e,t,r,n){return e/=n,-r*(Math.sqrt(1-e*e)-1)+t},easeOutCirc:function(e,t,r,n){return e/=n,e--,r*Math.sqrt(1-e*e)+t},easeInOutCirc:function(e,t,r,n){return(e/=n/2)<1?-r/2*(Math.sqrt(1-e*e)-1)+t:(e-=2,r/2*(Math.sqrt(1-e*e)+1)+t)}},Percentage:{XofY:function(e,t){return e/t*100}},Dist2D:function(e,t){if(e&&null!=e.x&&null!=e.y&&t&&null!=t.x&&null!=t.y){var r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}return 0},Midpoint2D:function(e,t){return e&&null!=e.x&&null!=e.y&&t&&null!=t.x&&null!=t.y?{x:(e.x+t.x)/2,y:(e.y+t.y)/2}:{x:0,y:0}},Dist3D:function(e,t){if(e&&null!=e.x&&null!=e.y&&t&&null!=t.x&&null!=t.y){var r=t.x-e.x,n=t.y-e.y,a=t.z-e.z;return Math.sqrt(r*r+n*n+a*a)}return 0}},color:{_component:function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},HexToRGB:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}},HexToHSV:function(e){var t=this.HexToRGB(e);return this.RGBToHSV(t.r,t.g,t.b)},RGBToHex:function(e,r,n){if(e&&!r&&!n&&t.is.object(e))var a=e.r,i=e.g,o=e.b;else a=e,i=r,o=n;return"#"+this._component(a)+this._component(i)+this._component(o)},RGBToHSV:function(){var e,t,r,n,a,i=arguments[0]/255,o=arguments[1]/255,s=arguments[2]/255,l=Math.max(i,o,s),d=l-Math.min(i,o,s),c=function(e){return(l-e)/6/d+.5};return 0==d?n=a=0:(a=d/l,e=c(i),t=c(o),r=c(s),i===l?n=r-t:o===l?n=1/3+e-r:s===l&&(n=2/3+t-e),n<0?n+=1:n>1&&(n-=1)),{h:Math.round(360*n),s:Math.round(100*a),v:Math.round(100*l)}},HSVToRGB:function(e,t,r){var n,a,i,o,s,l,d,c;if(e=Math.max(0,Math.min(360,e)),t=Math.max(0,Math.min(100,t)),r=Math.max(0,Math.min(100,r)),r/=100,0==(t/=100))return n=a=i=r,[Math.round(255*n),Math.round(255*a),Math.round(255*i)];switch(l=r*(1-t),d=r*(1-t*(s=(e/=60)-(o=Math.floor(e)))),c=r*(1-t*(1-s)),o){case 0:n=r,a=c,i=l;break;case 1:n=d,a=r,i=l;break;case 2:n=l,a=r,i=c;break;case 3:n=l,a=d,i=r;break;case 4:n=c,a=l,i=r;break;default:n=r,a=l,i=d}return{r:Math.round(255*n),g:Math.round(255*a),b:Math.round(255*i)}},HSVToHex:function(e,t,r){var n=this.HSVToRGB(e,t,r);return this.RGBToHex(n)},Saturate:function(e,r){var n=0,a=r||100;if(t.is.object(e)?e.h&&e.s&&e.v?n="HSV":e.r&&e.g&&e.b&&(n="RGB"):e.startsWith("#")&&(n="HEX"),0===n)return e;var i=0;switch(n){case"HSV":i=e;break;case"RGB":i=this.RGBToHSV(e.r,e.g,e.b);break;case"HEX":i=this.HexToHSV(e)}switch(i.s=a,n){case"HSV":return i;case"RGB":return this.HSVToRGB(i.h,i.s,i.v);case"HEX":return this.HSVToHex(i.h,i.s,i.v)}},Lightness:function(e,r){var n=0,a=r||100;if(t.is.object(e)?e.h&&e.s&&e.v?n="HSV":e.r&&e.g&&e.b&&(n="RGB"):e.startsWith("#")&&(n="HEX"),0===n)return e;var i=0;switch(n){case"HSV":i=e;break;case"RGB":i=this.RGBToHSV(e.r,e.g,e.b);break;case"HEX":i=this.HexToHSV(e)}switch(i.v=a,n){case"HSV":return i;case"RGB":return this.HSVToRGB(i.h,i.s,i.v);case"HEX":return this.HSVToHex(i.h,i.s,i.v)}}},cookies:{cookies:[],Read:function(){this.cookies=[];for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var r=e[t].split("="),n={name:r[0],value:r[1]};this.cookies.push(n)}},Clear:function(){this.Read();for(var e=0;e<this.cookies.length;e++)$cookie=this.cookies[e],document.cookie="{0}=; expires={1}".format($cookie.name,new Date(0).toUTCString())}},string:{pad:function(e,t,r){t&&""!==t&&0!==t.length||(t=" "),r||(r=2);for(var n=""+e;e.length<r;)n=t+n;return n}},fullscreen:{_fromUser:!1,get isFullscreen(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},get isUserFullScreen(){return this.isFullscreen&&this._fromUser},enter:function(e){e||(e=document.documentElement),this.isFullscreen||(e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)),this._fromUser=!0},exit:function(){this.isFullscreen&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()),this._fromUser=!1}},browser:{get isMobile(){return e.innerWidth<=1024},get isPortrait(){return e.innerWidth<e.innerHeight},get isTouch(){return"ontouchstart"in e},get isFirefox(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},get isChrome(){return navigator.userAgent.toLowerCase().indexOf("chrome")>-1},get isSafari(){return navigator.userAgent.toLowerCase().indexOf("safari")>-1&&!this.isChrome||navigator.userAgent.toLowerCase().indexOf("applewebkit")>-1&&!this.isChrome},get isOpera(){return navigator.userAgent.toLowerCase().indexOf("opera")>-1},get isMSIE(){return navigator.userAgent.toLowerCase().indexOf("trident")>-1},get isEdge(){return navigator.userAgent.toLowerCase().indexOf("edge/")>-1},get isIEMobile(){return navigator.userAgent.toLowerCase().indexOf("iemobile")>-1},get isWindowsPhone(){return navigator.userAgent.toLowerCase().indexOf("windows phone")>-1},get isWebkit(){return navigator.userAgent.toLowerCase().indexOf("webkit")>-1},get isiOS(){return this.isSafari&&this.isTouch},get isiOS7(){return this.isiOS&&navigator.userAgent.toLowerCase().indexOf("os 7")>-1},get supportsHistoryAPI(){return!(!e.history||!history.pushState)}},net:{request:function(e,t){var r={method:"GET",data:null,progress:null,load:null,error:null,abort:null,finished:null};exHelp.extend(r,t);var n=new XMLHttpRequest;if(n.onprogress=function(e){r.progress&&exHelp.is.function(r.progress)&&r.progress(e)},n.onabort=function(e){r.abort&&exHelp.is.function(r.abort)&&r.abort(e)},n.onerror=function(e){r.error&&exHelp.is.function(r.error)&&r.error(e)},n.onload=function(e){r.load&&exHelp.is.function(r.load)&&r.load(e)},n.onreadystatechange=function(e){switch(n.readyState){case XMLHttpRequest.OPENED:case XMLHttpRequest.HEADERS_RECEIVED:case XMLHttpRequest.LOADING:case XMLHttpRequest.UNSENT:break;case XMLHttpRequest.DONE:var t=200==n.status;r.finished&&exHelp.is.function(r.finished)&&r.finished(t,n.responseText,n)}},n.open(r.method,e),r.data&&"POST"==r.method){var a,i=function(e,t){var r=[];for(var n in e)if(e.hasOwnProperty(n)){var a=t?t+"["+n+"]":n,o=e[n];r.push("object"==typeof o?i(o,a):encodeURIComponent(a)+"="+encodeURIComponent(o))}return r.join("&")};a=i(r.data),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(a)}else n.send()}},
//! Other checking functions
is:{string:function(e){return!!("string"==typeof e||e instanceof String)},function:function(e){return!!("function"==typeof e||e instanceof Function)},object:function(e){return!!("object"==typeof e||e instanceof Object)},array:Array.isArray,arraylike:function(e){return void 0!==e&&void 0!==e.length},number:function(e){return!isNaN(e)&&isFinite(e)&&!1!==e&&!0!==e&&null!=e},mouse_event:function(e){return!!("MouseEvent"==typeof e||e instanceof MouseEvent)},keyboard_event:function(e){return!!("KeyboardEvent"==typeof e||e instanceof KeyboardEvent)}},browserNotification:{_mode:0,_permission:1,_api:null,_counter:0,permissions:{get ALLOWED(){return 0},get NOT_ALLOWED(){return 1},get DENIED(){return 2}},modes:{get NONE(){return 0},get W3C(){return 1},get WEBKIT(){return 2}},_list:[],Init:function(){if(this.Check_Support(!0))switch(this.Permission.Check(!0)){case this.permissions.ALLOWED:break;case this.permissions.NOT_ALLOWED:this.Permission.Request(),p.browserNotification.Init();case this.permissions.DENIED:}},Check_Support:function(r){if(t.isSafari)return this._api=null,!1;var n=function(e){return!!(e&&e.checkPermission&&e.createNotification&&e.requestPermission)};return n(e.Notification)&&r&&(this._api=e.Notification),n(e.webkitNotifications)&&r&&(this._api=e.webkitNotifications),r?!!this._api:n(e.Notification)||n(e.webkitNotifications)},Permission:{Check:function(e){if(t.browserNotification._api||t.browserNotification.Check_Support(!0)){var r=t.browserNotification._api.checkPermission();return e&&(t.browserNotification._permission=r),r}},Request:function(){return p.browserNotification._api.requestPermission()}},_Push_Basic:function(e){if(t.settings.useNativeNotifications&&this.Check_Support()&&this.Permission.Check()===this.permissions.ALLOWED){var r=e.title||t.info.AppName,n=e.content||e.msg||e.message||e.txt||e.text,a=e.img||e.pic||"favicon.png",i=e.show||e.onshow||e.onShow||e.display||e.ondisplay||e.onDisplay,o=e.close||e.onClose||e.hide||e.onHide,s=this._api.createNotification(a,r,n);return i&&exHelp.is.isFunction(i)&&(s.ondisplay=i),o&&exHelp.is.isFunction(o)&&(s.onclose=o),s.show(),this._list[this._counter.toString()]=s,{notification:s,id:this._counter++}}},Push:function(e,t){return this._Push_Basic({title:e,content:t})},PushWithImage:function(e,t,r){return this._Push_Basic({title:e,content:t,img:r})},PushAdvanced:function(e){return this._Push_Basic(e)}},locale:{_locale:"en",set:function(e){this._locale=e},getString:function(e){var r=t.storage("locale");return r[this._locale]&&r[this._locale][e]?r[this._locale][e]:e}}};e.exHelp=t,e.exHelpExtend=function(e){t.extend(e)}}(window),String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,(function(t,r){return void 0!==e[r]?e[r]:t}))},String.prototype.startsWith=function(e){return this.slice(0,e.length)==e},String.prototype.endsWith=function(e){return this.slice(-e.length)==e},String.prototype.contains=function(e){return-1!==this.indexOf(e)},String.prototype.repeat=function(e){for(var t=this,r="";1&e&&(r+=t),e>>=1;)t+=t;return r},
/*!

exHelp Library - Element Helper Plugin // Version 1.0.0.0
http://www.github.com/xwcg

The MIT License (MIT)

Copyright (c) 2016 Michael Schwarz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
function e(t){let r=["exHelp","exHelpExtend"],n=0;for(;n<r.length;n++)if(null==t[r[n]])return setTimeout(e,100,t);let a=function(e,t){return new a.functions.init(e,t)},i={e:a,isExElement:function(e){return!!(e instanceof exHelp.e)}},o="_dom_ready",s=function(){document.removeEventListener("DOMContentLoaded",s),t.removeEventListener("load",s),exHelp.trigger(o)};document.addEventListener("DOMContentLoaded",s),t.addEventListener("load",s),a.functions=a.prototype={constructor:a,init:function(e,r){if(!e)return this;let n=[];if(exHelp.is.string(e)){if("<"==e.charAt(0)&&e.length>=3&&">"==e.charAt(e.length-1)){let i=t.document.createElement("div");return i.innerHTML=e,n=i.childNodes,new a(n,r)}n=t.document.querySelectorAll(e);for(let e=0;e<n.length;e++)this[e]=n[e];this.length=n.length}else if(!exHelp.is.arraylike(e)||e instanceof HTMLElement){if(exHelp.is.object(e)){if(e instanceof exHelp.e)return e;this.context=this[0]=e,this.length=1}}else{let t,i=e.length,o=0;for(;o<i;o++)t=e[o]instanceof exHelp.e?e[o]:new a(e[o],r),t.length>0&&n.push(t[0]);for(i=n.length,o=0;o<i;o++)this[o]=n[o];this.length=n.length}return this._applyOptions(r),this},length:0,each:function(e){for(let t=0;t<this.length;t++)if(!1===e.call(this[t],t,this[t]))return!1;return!0},_applyOptions:function(e){let t,r;for(t in e)switch(r=e[t],t.toLowerCase()){case"html":if(r&&r.startsWith&&r.startsWith("__LOCALE__:")){let e=r.split(":")[1];this.setHtml(exHelp.locale.getString(e))}else this.setHtml(r);break;case"class":this.addClass(r);break;case"width":case"height":case"top":case"left":case"right":case"bottom":case"position":this.setStyle(t,r);break;default:this.setAttr(t,r)}},setAttr:function(e,t){return this.each((function(){void 0!==this.setAttribute&&this.setAttribute(e,t)})),this},removeAttr:function(e,t){return this.each((function(){void 0!==this.removeAttribute&&this.removeAttribute(e,t)})),this},getAttr:function(e){let t=null;return this.each((function(){if(void 0!==this.getAttribute&&(t=this.getAttribute(e)),null==t){let r=this.attributes,n=r.length,a=0;for(;a<n;a++){let n=r[a],i=n.name||n.nodeName,o=n.value||n.nodeValue||n.textContent;if(i==e){t=o;break}}}})),t},setHtml:function(e){return this.each((function(){void 0!==this.innerHTML?this.innerHTML=e:void 0!==this.textContent&&(this.textContent=e)})),this},getHtml:function(){let e=null;return this.each((function(){void 0!==this.innerHTML?e=this.innerHTML:void 0!==this.textContent&&(e=this.textContent)})),e},empty:function(){return this.setHtml("")},remove:function(){return this.each((function(){this.remove(),this.ownerDocument=null})),this},children:function(){let e=[];return this.each((function(){let t=0,r=this.childNodes,n=r.length;for(;t<n;t++)e.push(r[t])})),new a(e)},find:function(e){if(!e)return new a([]);let t,r,n,i=[],o="."==e.charAt(0),s="#"==e.charAt(0),l=o||s?e.substr(1):e;return this.each((function(){if(t=new a(this),(o&&t.hasClass(l)||s&&t.getAttr("id")==l||!o&&!s&&t[0].nodeName.toLowerCase()==l.toLowerCase())&&i.push(this),this.childNodes.length>0&&(t=t.children().find(e),n=t.length,n>0))for(r=0;r<n;r++)i.push(t[r])})),new a(i)},exclusive:function(e){let t,r=[],n="."==e.charAt(0),i="#"==e.charAt(0),o=n||i?e.substr(1):e;return this.each((function(){t=new a(this),(n&&t.hasClass(o)||i&&t.getAttr("id")==o||!n&&!i&&t[0].nodeName.toLowerCase()==o.toLowerCase())&&r.push(this)})),new a(r)},getWidth:function(){return parseFloat(this.getComputedStyle("width"))},getHeight:function(){return parseFloat(this.getComputedStyle("height"))},getParents:function(e){let t=[],r=void 0!==e,n=r&&e.startsWith("."),i=r&&e.startsWith("#"),o=function(s){if(s){let l=new a(s);if(t.push(s),r&&(n&&l.hasClass(e)||i&&l.getAttr("id")==e))return!1;if(s.parentNode)return o(s.parentNode)}};return this.each((function(){this&&o(this.parentNode)})),new a(t)},getParent:function(){let e=null;return this.each((function(){if(null!=this&&null!=this.parentNode)return e=new a(this.parentNode),!1})),e},getPageXY:function(){let e=document.fullScreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement,t={x:0,y:0},r=function(n){exHelp.fullscreen.isFullscreen&&e==n||(t.x+=n.offsetLeft,t.y+=n.offsetTop,n.offsetParent&&r(n.offsetParent))};return this.each((function(){r(this)})),t},getPageBounds:function(){let e=this.getPageXY();return{left:e.x,top:e.y,right:e.x+this.getWidth(),bottom:e.y+this.getHeight()}},getRelativeXY:function(e){let t={x:0,y:0},r="."==e.charAt(0),n="#"==e.charAt(0),i=r||n?e.substr(1):e,o=function(e){let s=new a(e);if(r&&s.hasClass(i)||n&&s.getAttr("id")==i||!r&&!n&&s[0].nodeName.toLowerCase()==i.toLowerCase())return!1;t.x+=e.offsetLeft,t.y+=e.offsetTop,e.offsetParent&&o(e.offsetParent)};return this.each((function(){o(this)})),t},getRelativeBounds:function(e){let t=this.getRelativeXY(e);return{left:t.x,top:t.y,right:t.x+this.getWidth(),bottom:t.y+this.getHeight()}},getRelativeBoundingClientRect:function(){let e=null,t=this.getPageBounds();if(this.each((function(){e=this.getBoundingClientRect()})),null!=e){return{top:e.top-t.top,left:e.left-t.left,right:e.right-t.right,bottom:e.bottom-t.bottom,width:e.width,height:e.height}}return t},getComputedStyle:function(e){let r=null;return this.each((function(){r=t.getComputedStyle?t.getComputedStyle(this,null).getPropertyValue(e):this.currentStyle?this.currentStyle[e]:this.style[e]})),r},addClass:function(e){let t=e.split(" ");return this.each((function(){let e=this.className.split(" ");for(let r=0;r<t.length;r++)exHelp.array.contains(e,t[r])||e.push(t[r]);this.className=e.join(" ").trim()})),this},removeClass:function(e){let t=e.split(" ");return this.each((function(){let e=this.className.split(" ");for(let r=0;r<t.length;r++)exHelp.array.contains(e,t[r])&&e.splice(e.indexOf(t[r]),1);this.className=e.join(" ").trim()})),this},toggleClass:function(e){let t=e.split(" ");return this.each((function(){let e=this.className.split(" ");for(let r=0;r<t.length;r++)exHelp.array.contains(e,t[r])?e.splice(e.indexOf(t[r]),1):e.push(t[r]);this.className=e.join(" ").trim()})),this},hasClass:function(e){let t=!1;return this.each((function(){let r=this.className?this.className.split(" "):[];if(exHelp.array.contains(r,e))return t=!0,!1})),t},setStyle:function(e,t){this.each((function(){this.style[e]=t}))},contains:function(e){let t=!1,r=e instanceof a?e[0]:e;return this.each((function(){if(this.contains(r))return t=!0,!1})),t},appendTo:function(e){return e=new a(e),this.each((function(){let t=this;e.each((function(){this.appendChild(t)}))})),this},prependTo:function(e){return e=new a(e),this.each((function(){let t=this;e.each((function(){this.insertBefore(t,this.firstChild)}))})),this},indexInParent:function(){let e=0;return this.each((function(){let t=this;for(;t=t.previousSibling;)e++})),e},hasParent:function(e){return!!e[0].contains(this[0])},_evtQueue:function(){let e=[];this.add=function(t){e.push(t)},this.call=function(t){for(let r=0,n=e.length;r<n;r++)e[r].call(t)},this.remove=function(t){let r=[];for(let n=0,a=e.length;n<a;n++)e[n]!==t&&r.push(e[n])},this.length=function(){return e.length}},on:function(e,t){let r=[],n=this;if(exHelp.is.string(e))if(e.contains(" "))r=e.split(" ");else if(e.contains(",")){r=e.split(",");for(let e=0;e<r.length;e++)r[e]=r[e].trim()}else r.push(e);let i,s=0,l=r.length;for(;s<l;s++)switch(i=r[s],i){case"ready":exHelp.subscribe(o,t);break;case"tap":let e=function(e){let t=!1,r=!1,n=new a(e);e.addEventListener("touchstart",(function(e){r=!1,t=!0,n.addClass("pressed")}),{passive:!0}),e.addEventListener("touchcancel",(function(e){r||(r=!0,t=!1,n.removeClass("pressed"))}),{passive:!0}),e.addEventListener("touchmove",(function(n){if(!r){let r=new a(e).getPageBounds();if(n&&n.touches&&n.touches.length>0){let a=n.touches[0];(a.pageX<r.left||a.pageX>r.right||a.pageY<r.top||a.pageY>r.bottom)&&(t=!1,e.dispatchEvent(new TouchEvent("touchcancel")))}}}),{passive:!0}),e.addEventListener("touchend",(function(a){r||t&&(a&&a.preventDefault&&a.preventDefault(),a&&a.stopPropagation&&a.stopPropagation(),e._ehe_queue_tap.call(e),t=!1,n.removeClass("pressed"))}))};this.each((function(){this._ehe_queue_tap||(this._ehe_queue_tap=new n._evtQueue),this._ehe_taphandler||(this._ehe_taphandler=new e(this)),this._ehe_queue_tap.add(t)}));break;case"resize":let r=function(){if(this instanceof Element){if(this._ehe_resize_handler)this._ehe_queue_resize.add(t);else{this._ehe_queue_resize||(this._ehe_queue_resize=new a.functions._evtQueue),this._ehe_queue_resize.add(t),this._ehe_resize_handler=document.createElement("div");let e=this,r="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",n="position: absolute; left: 0; top: 0; transition: 0s;";this._ehe_resize_handler.className="ehe-resize-event-dummy",this._ehe_resize_handler.style.cssText=r,this._ehe_resize_handler.innerHTML='<div class="resize-sensor-expand" style="{0}"><div style="{1}"></div></div><div class="resize-sensor-shrink" style="{0}"><div style="{1} width: 200%; height: 200%"></div></div>'.format(r,n),this.appendChild(this._ehe_resize_handler);let i,o,s,l,d=this._ehe_resize_handler.childNodes[0],c=d.childNodes[0],g=this._ehe_resize_handler.childNodes[1],h=function(){c.style.width="100000px",c.style.height="100000px",d.scrollLeft=1e5,d.scrollTop=1e5,g.scrollLeft=1e5,g.scrollTop=1e5};h();let p=function(){(s=e.offsetWidth)==i&&(l=e.offsetHeight)==o||(e._ehe_queue_resize.call(this),i=s,o=l),h()};d.addEventListener("scroll",p),g.addEventListener("scroll",p)}return!1}};if(!1===this.each(r))break;default:this.each((function(){this.addEventListener(i,t)}))}return this},off:function(e,t){let r=[];if(exHelp.is.string(e))if(e.contains(" "))r=e.split(" ");else if(e.contains(",")){r=e.split(",");for(let e=0;e<r.length;e++)r[e]=r[e].trim()}else r.push(e);let n,a=0,i=r.length;for(;a<i;a++)switch(n=r[a],n){case"ready":exHelp.unsubscribe(o,t);break;case"tap":this.each((function(){this._ehe_queue_tap&&this._ehe_queue_tap.remove(t)}));break;case"resize":let e=function(){this instanceof Element&&this._ehe_queue_resize&&this._ehe_queue_resize.remove(t)};if(!1===this.each(e))break;default:this.each((function(){this.removeEventListener(n,t)}))}return this}},a.functions.init.prototype=a.functions,a.extend=a.functions.extend=function(e){exHelp.extend(this,e)},t.exHelpExtend(i)}(window),function e(t){if(null==t.exHelp||null==t.exHelpExtend||null==t.exHelp.e)return setTimeout(e,100,t);var r=exHelp,n={reader:{container:null,path:null,render_canvas:null,sound:null,dbg_log:[],dbg:function(e){},settings:{language:"en",show_go_to_page:!1,preload:!1,custom_background:null,custom_backgound_mode:null,start_page:1,no_pdf:!1,slideshow_mode:!1,slideshow_timing:5,slideshow_controls:!1,slideshow_pdf:!1,page_mode:"auto",page_sound:0,page_sound_volume:1,show_zoom:!0,enable_pinching:!1,enable_double_tapping:!1,enable_mousewheel_zoom:!1,zoom_max:4,zoom_min:"auto",zoom_doubleclick:1,zoom_wheel_step:.1,zoom_button_step:.1,enable_dragging:!0,enable_scrollbars:!1,show_fullscreen:!0,hide_in_fullscreen:!0,show_invert:!1,show_download:!1,show_overview:!0,overview_direction:"bottom",overview_overlay:!1,overview_size:150,overview_start_open:!1,enable_keyboard_navigation:!1,enable_swiping:!1,enable_arrows:!1,social_twitter:null,social_facebook:null,social_google:null,social_email:!1,enable_printing:!1,small_controls:!1},control_assignments:{overview:"bottomright-ver",fullscreen:"bottomright-ver",invert:"topright-hor","zoom-in":"topright-hor","zoom-out":"topright-hor","go-back":"left","go-fwd":"right",download:"bottomleft-hor",goto:"bottomleft-hor","ss-back":"bottom","ss-play":"bottom","ss-pause":"bottom","ss-fwd":"bottom"},elements:[{selector:".content",construct:"<div>",options:{class:"content",tabindex:0},children:[{selector:".pages",options:{class:"pages"},children:[{selector:".overlayer",options:{class:"overlayer"}}]}]},{selector:".controls",options:{class:"controls"},children:[{selector:".topleft",options:{class:"topleft"},children:[{selector:".horizontal",options:{class:"horizontal flex"}},{selector:".vertical",options:{class:"vertical flex"}}]},{selector:".topright",options:{class:"topright"},children:[{selector:".horizontal",options:{class:"horizontal flex"}},{selector:".vertical",options:{class:"vertical flex"}}]},{selector:".bottomleft",options:{class:"bottomleft"},children:[{selector:".horizontal",options:{class:"horizontal flex"}},{selector:".vertical",options:{class:"vertical flex"}}]},{selector:".bottomright",options:{class:"bottomright"},children:[{selector:".horizontal",options:{class:"horizontal flex"}},{selector:".vertical",options:{class:"vertical flex"}}]},{selector:".top",options:{class:"top flex horizontal center-content"}},{selector:".left",options:{class:"left flex vertical center-content"}},{selector:".bottom",options:{class:"bottom flex horizontal center-content"}},{selector:".right",options:{class:"right flex vertical center-content"}}]},{selector:".overviews",options:{class:"overviews"}},{selector:".main-loader",options:{class:"main-loader loader"}},{selector:".status",options:{class:"status flex horizontal"},children:[{selector:".loader",options:{class:"loader"},children:[{selector:".spinner",options:{class:"spinner"}}]},{selector:".text",options:{class:"text",html:"__LOCALE__:LOADING"}},{selector:".finished-overlay",options:{class:"finished-overlay hidden",html:"__LOCALE__:LOADING_FINISHED"}},{selector:".error-overlay",options:{class:"error-overlay hidden",html:"__LOCALE__:LOADING_ERROR"}}]},{selector:".render-canvas",construct:"<canvas>",options:{class:"render-canvas"}}],checkFileExists:function(e,t){r.net.request(e,{method:"HEAD",finished:function(e,n,a){t&&r.is.function(t)&&t(e&&200==a.status)}})},makeMessage:function(e,t,n){var a=r.e("<div>",{class:"message"}),i=r.e("<div>",{class:"title",html:e}),o=r.e("<div>",{class:"text",html:t}),s=r.e("<div>",{class:"button",html:"OK"});return i.appendTo(a),o.appendTo(a),s.appendTo(a),s.on("click",(function(){a.remove(),n&&r.is.function(n)&&n()})),a},loadPdfProcessor:function(e){e()},loadLocale:function(e){e()},loadAudioPath:function(){var e=r.e("script"),t=null;return e.each((function(){if(this.src.contains("magalone."))return t=this.src,!1})),null!=t?(r.pager.current_script=t,r.pager.current_script.substr(0,r.pager.current_script.lastIndexOf("/")-3)+"/sound/page-flip-"):"./"},svgLoaded:!1,loadSvgFilters:function(){r.e('<svg version="1.1" xmlns:svg="http://www.w3.org/2000/svg" height="0"><filter id="invert"><feComponentTransfer><feFuncR type="table" tableValues="1 0"></feFuncR><feFuncG type="table" tableValues="1 0"></feFuncG><feFuncB type="table" tableValues="1 0"></feFuncB></feComponentTransfer></filter></svg>',{style:"display:none;"}).appendTo("body"),this.svgLoaded=!0},playPageSound:function(){null!=r.reader.sound&&(r.reader.sound[0].pause(),r.reader.sound[0].currentTime=0,r.reader.sound[0].play())},get:function(e,t){var n=r.reader.container.getAttr("data-"+e);return null==n?void 0===t?null:t:n},getBoolean:function(e,t){var r=this.get(e);return null==r?void 0!==t&&t:"true"==r},lastFullscreenElement:null,onFullscreenChange:function(e){var t=document.fullScreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement,n="";n=null==r.reader.lastFullscreenElement?"enter":"exit",r.trigger("fullscreen",[n,t||r.reader.lastFullscreenElement]),r.reader.lastFullscreenElement=t},init:function(){var e,t=this;this.container=r.e("#reader-container"),this.container.length>0&&(this.path=this.get("path")),this.container.length>0&&null!=this.path&&this.path.length>0&&(this.settings.language=this.get("language","en"),r.locale.set(this.settings.language),this.settings.start_page=parseInt(this.get("start-page","1")),this.settings.no_pdf=this.getBoolean("no-pdf",!1),this.settings.show_fullscreen=this.getBoolean("show-fullscreen",!0),this.settings.hide_in_fullscreen=this.getBoolean("immersive-fullscreen",!1),this.settings.show_invert=this.getBoolean("show-invert"),this.settings.show_overview=this.getBoolean("show-thumbnails"),this.settings.overview_overlay=this.getBoolean("thumbnails-overlay"),this.settings.overview_direction=this.get("thumbnails-direction","bottom"),this.settings.overview_size=parseInt(this.get("thumbnails-size","150")),this.settings.overview_start_open=this.getBoolean("thumbnails-start-open"),this.settings.show_zoom=this.getBoolean("show-zoom"),this.settings.enable_pinching=this.getBoolean("enable-pinching"),this.settings.enable_double_tapping=this.getBoolean("enable-double-click"),this.settings.enable_mousewheel_zoom=this.getBoolean("enable-mouse-wheel"),this.settings.zoom_wheel_step=parseInt(this.get("zoom-wheel","10"))/100,this.settings.zoom_max=parseInt(this.get("zoom-max","400"))/100,this.settings.zoom_min="auto"==(e=this.get("zoom-min","auto"))?"auto":parseInt(e)/100,this.settings.zoom_doubleclick=parseInt(this.get("zoom-doubleclick","100"))/100,this.settings.enable_keyboard_navigation=this.getBoolean("enable-keyboard",!0),this.settings.enable_swiping=this.getBoolean("enable-swiping",!0),this.settings.enable_arrows=this.getBoolean("enable-arrows",!0),this.settings.preload=this.getBoolean("preload",!0),//!
this.settings.show_download=this.getBoolean("show-download",!1),this.settings.show_go_to_page=this.getBoolean("show-go-to-page",!1),//!
this.settings.slideshow_mode=this.getBoolean("slideshow",!1),this.settings.slideshow_timing=parseFloat(this.get("slideshow-time","5")),this.settings.slideshow_controls=this.getBoolean("slideshow-show-controls",!1),this.settings.slideshow_pdf=this.getBoolean("slideshow-use-pdf",!1),this.settings.small_controls=this.getBoolean("small-controls",!1),this.settings.page_sound=parseInt(this.get("page-sound","0")),this.settings.page_sound_volume=parseInt(this.get("page-sound-volume","100"))/100,this.settings.page_mode=this.get("page-mode","auto"),"auto"!=this.settings.page_mode&&("single"==this.settings.page_mode?(r.pager.current_mode_manual=!0,r.pager.current_mode=r.pager.constant.SINGLE):"double"==this.settings.page_mode&&(r.pager.current_mode_manual=!0,r.pager.current_mode=r.pager.constant.DOUBLE)),this.loadLocale((function(){if(t.prepareElements(),r.overlays.init(),document.addEventListener("fullscreenchange",r.reader.onFullscreenChange),document.addEventListener("mozfullscreenchange",r.reader.onFullscreenChange),document.addEventListener("webkitfullscreenchange",r.reader.onFullscreenChange),document.addEventListener("MSFullscreenChange",r.reader.onFullscreenChange),t.render_canvas=t.container.find(".render-canvas"),t.settings.enable_scrollbars&&t.container.find(".content").addClass("scrollbars"),t.settings.small_controls&&t.container.find(".controls").addClass("small"),t.settings.slideshow_mode&&(r.pager.current_mode_manual=!0,r.pager.current_mode=r.pager.constant.SINGLE),t.settings.page_sound>0&&t.settings.page_sound<=20){try{t.sound=r.e("<audio>",{preload:"auto"})}catch(e){t.sound=r.e("<audio>")}if(null!=t.sound){var e=t.loadAudioPath();if(t.sound[0].canPlayType("audio/mp3"))r.e("<source>",{src:e+t.settings.page_sound+".mp3",type:"audio/mp3"}).appendTo(t.sound);if(t.sound[0].canPlayType("audio/aac"))r.e("<source>",{src:e+t.settings.page_sound+".aac",type:"audio/aac"}).appendTo(t.sound);if(t.sound[0].canPlayType("audio/ogg"))r.e("<source>",{src:e+t.settings.page_sound+".ogg",type:"audio/ogg"}).appendTo(t.sound);if(t.sound[0].canPlayType("audio/wav"))r.e("<source>",{src:e+t.settings.page_sound+".wav",type:"audio/wav"}).appendTo(t.sound);t.sound.appendTo(t.container);try{t.sound[0].volume=t.settings.page_sound_volume}catch(e){console.error("AUDIO is not supported by browser"),t.sound=null}}}t.checkFileExists(t.path+"/cover_small.jpg",(function(e){e?(t.prepareCover(),t.prepareData(),t.prepareControls()):r.net.request(t.path+"/upload.php",{method:"POST",data:{cmd:"ping"},finished:function(e,n){e?"pong"==n?t.loadPdfProcessor((function(){r.processing.init(t.path)})):t.makeMessage(r.locale.getString("ERROR_TITLE"),n).appendTo(t.container):t.makeMessage(r.locale.getString("ERROR_TITLE"),r.locale.getString("ERROR_UPLOAD_PHP")).appendTo(t.container)}})}))})))},setProgress:function(e){var t=r.e("div.status .text");e<0?t.setHtml(r.locale.getString("LOADING")):e>=0&&e<100?t.setHtml(e.toFixed(0)+"%"):"error"==e?(r.e(".error-overlay").removeClass("hidden"),setTimeout((function(){r.e(".status").addClass("gone")}),1e3)):(r.e(".finished-overlay").removeClass("hidden"),setTimeout((function(){r.e(".status").addClass("gone")}),1e3))},prepareControls:function(){var e={fullscreen:{selector:".ctrl.btn.fullscreen",options:{class:"ctrl btn fullscreen"},children:[{selector:".icon.on",options:{class:"icon on",html:"fullscreen_exit"}},{selector:".icon.off",options:{class:"icon off",html:"fullscreen"}}]},overview:{selector:".ctrl.btn.overview",options:{class:"ctrl btn overview"},children:[{selector:".icon",options:{class:"icon",html:"view_module"}}]},invert:{selector:".ctrl.btn.invert",options:{class:"ctrl btn invert"},children:[{selector:".icon",options:{class:"icon",html:"invert_colors"}}]},"zoom-in":{selector:".ctrl.btn.zoom-in",options:{class:"ctrl btn zoom-in"},children:[{selector:".icon",options:{class:"icon",html:"zoom_in"}}]},"zoom-out":{selector:".ctrl.btn.zoom-out",options:{class:"ctrl btn zoom-out"},children:[{selector:".icon",options:{class:"icon",html:"zoom_out"}}]},"go-back":{selector:".ctrl.btn.go-back",options:{class:"ctrl btn go-back"},children:[{selector:".icon",options:{class:"icon",html:"keyboard_arrow_left"}}]},"go-fwd":{selector:".ctrl.btn.go-fwd",options:{class:"ctrl btn go-fwd"},children:[{selector:".icon",options:{class:"icon",html:"keyboard_arrow_right"}}]},download:{construct:"<a>",selector:".ctrl.btn.download",options:{class:"ctrl btn download",href:r.pager.getPDFPath(),target:"_blank"},children:[{selector:".icon",options:{class:"icon",html:"file_download"}}]},goto:{selector:".ctrl.btn.goto",options:{class:"ctrl btn goto"},children:[{selector:".icon",options:{class:"icon",html:"input"}}]},"ss-back":{selector:".ctrl.btn.ss-back",options:{class:"ctrl btn ss-back"},children:[{selector:".icon",options:{class:"icon",html:"skip_previous"}}]},"ss-play":{selector:".ctrl.btn.ss-play",options:{class:"ctrl btn ss-play"},children:[{selector:".icon",options:{class:"icon",html:"play_arrow"}}]},"ss-pause":{selector:".ctrl.btn.ss-pause",options:{class:"ctrl btn ss-pause"},children:[{selector:".icon",options:{class:"icon",html:"pause"}}]},"ss-fwd":{selector:".ctrl.btn.ss-fwd",options:{class:"ctrl btn ss-fwd"},children:[{selector:".icon",options:{class:"icon",html:"skip_next"}}]}},t={"topleft-hor":r.e(".controls .topleft .horizontal"),"topright-hor":r.e(".controls .topright .horizontal"),"bottomleft-hor":r.e(".controls .bottomleft .horizontal"),"bottomright-hor":r.e(".controls .bottomright .horizontal"),"topleft-ver":r.e(".controls .topleft .vertical"),"topright-ver":r.e(".controls .topright .vertical"),"bottomleft-ver":r.e(".controls .bottomleft .vertical"),"bottomright-ver":r.e(".controls .bottomright .vertical"),top:r.e(".controls .top"),left:r.e(".controls .left"),right:r.e(".controls .right"),bottom:r.e(".controls .bottom")},n=1;for(var a in e){var i=t[this.control_assignments[a]]||t["topleft-hor"];this._prepareElement(e[a],i).setAttr("tabindex",n++)}if(this.settings.show_fullscreen){r.e(".ctrl.btn.fullscreen").on("click",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),r.is.keyboard_event(e)&&13!=e.keyCode&&32!=e.keyCode||(r.fullscreen.isFullscreen?r.fullscreen.exit():r.fullscreen.enter(r.reader.container[0]))})),r.fullscreen.isFullscreen?r.e(".ctrl.btn.fullscreen").addClass("on").removeClass("off"):r.e(".ctrl.btn.fullscreen").addClass("off").removeClass("on");r.subscribe("fullscreen",(function(e,t){"reader-container"==r.e(t).getAttr("id")&&("exit"==e?(r.e(".ctrl.btn:not(.fullscreen)").removeClass("immersive"),r.reader.container.removeClass("fullscreen"),r.pager.adjust({reload:!0}),r.e(".ctrl.btn.fullscreen").addClass("off").removeClass("on")):(r.reader.settings.hide_in_fullscreen&&r.e(".ctrl.btn:not(.fullscreen)").addClass("immersive"),r.reader.container.addClass("fullscreen"),r.pager.adjust({reload:!0}),r.e(".ctrl.btn.fullscreen").addClass("on").removeClass("off")),r.pager.calculateAutozoom())}))}else r.e(".ctrl.btn.fullscreen").addClass("gone");this.settings.show_overview?r.e(".ctrl.btn.overview").on("click tap",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),r.reader.overview.toggle()})):r.e(".ctrl.btn.overview").addClass("gone"),this.settings.show_invert&&!r.browser.isMSIE?r.e(".ctrl.btn.invert").on("click tap",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),r.reader.toggleInvert()})):r.e(".ctrl.btn.invert").addClass("gone"),this.settings.show_zoom?(r.e(".ctrl.btn.zoom-in").on("click tap",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),r.pager.setZoom(r.pager.current_zoom+r.reader.settings.zoom_button_step),r.pager.adjust({reload:!0})})),r.e(".ctrl.btn.zoom-out").on("click tap",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),r.pager.setZoom(r.pager.current_zoom-r.reader.settings.zoom_button_step),r.pager.adjust({reload:!0})}))):r.e([".ctrl.btn.zoom-in",".ctrl.btn.zoom-out"]).addClass("gone"),this.settings.enable_arrows?(r.e(".ctrl.btn.go-fwd").on("click tap",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),null==r.pager.current_animator?r.pager.goForward():r.pager.current_animator.doFullAnimationNext()})),r.e(".ctrl.btn.go-back").on("click tap",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),null==r.pager.current_animator?r.pager.goBack():r.pager.current_animator.doFullAnimationPrev()}))):r.e([".ctrl.btn.go-fwd",".ctrl.btn.go-back"]).addClass("gone"),this.settings.show_download?r.e(".ctrl.btn.download").on("click tap",(function(e){e&&e.stopPropagation&&e.stopPropagation()})):r.e(".ctrl.btn.download").addClass("gone"),this.settings.show_go_to_page?r.e(".ctrl.btn.goto").on("click tap",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation()})):r.e(".ctrl.btn.goto").addClass("gone"),this.settings.slideshow_mode&&this.settings.slideshow_controls?(r.e(".ctrl.btn.ss-back").on("click tap",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),r.reader.slideshow.prev_manual()})),r.e(".ctrl.btn.ss-fwd").on("click tap",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),r.reader.slideshow.next_manual()})),r.e(".ctrl.btn.ss-pause").on("click tap",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),r.reader.slideshow.pause()})),r.e(".ctrl.btn.ss-play").on("click tap",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),r.reader.slideshow.play()})),r.e(".ctrl.btn.ss-play").addClass("gone")):r.e([".ctrl.btn.ss-back",".ctrl.btn.ss-pause",".ctrl.btn.ss-play",".ctrl.btn.ss-fwd"]).addClass("gone")},slideshow:{timeout:null,play_timeout:function(){r.pager.goForward((function(){r.reader.slideshow.timeout=setTimeout(r.reader.slideshow.play_timeout,1e3*r.reader.settings.slideshow_timing),r.pager.current_page==r.pager.page_count&&(r.pager.current_page=0)}))},play:function(){r.e(".ctrl.btn.ss-play").addClass("gone"),r.e(".ctrl.btn.ss-pause").removeClass("gone"),r.reader.slideshow.timeout=setTimeout(r.reader.slideshow.play_timeout,1e3*r.reader.settings.slideshow_timing)},pause:function(){r.e(".ctrl.btn.ss-pause").addClass("gone"),r.e(".ctrl.btn.ss-play").removeClass("gone"),clearTimeout(r.reader.slideshow.timeout)},next_manual:function(){r.reader.slideshow.pause(),r.pager.goForward()},prev_manual:function(){r.reader.slideshow.pause(),r.pager.goBack()}},overview:{isInited:!1,isFirstOpen:!0,isOpen:!1,container:null,thumbs:[],delta:0,interval:null,ensureInit:function(){if(!this.isInited){var e=this,n=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,a=t.cancelAnimationFrame||t.mozCancelAnimationFrame;switch(this.container=r.e("#reader-container .overviews"),this.container.addClass(r.reader.settings.overview_direction+(r.reader.settings.overview_overlay?" float":" solid")),this.container.addClass("hidden"),r.reader.settings.overview_direction){case"left":case"right":this.container.setAttr("style","width: {0}px".format(r.reader.settings.overview_size));break;case"top":case"bottom":this.container.setAttr("style","height: {0}px".format(r.reader.settings.overview_size))}this.container.on("wheel",(function(t){switch(t&&t.preventDefault&&t.preventDefault(),t&&t.stopPropagation&&t.stopPropagation(),r.reader.settings.overview_direction){case"left":case"right":e.container[0].scrollTop+=t.deltaY;break;case"top":case"bottom":e.container[0].scrollLeft+=t.deltaY}}));var i=!1,o=null,s=null,l=1,d=function(e){if(!e.type.startsWith("touch"))return{x:e.pageX,y:e.pageY};if(1==e.touches.length)return{x:e.touches[0].pageX,y:e.touches[0].pageY};if(2==e.touches.length){var t={x:e.touches[0].pageX,y:e.touches[0].pageY},n={x:e.touches[1].pageX,y:e.touches[1].pageY},a=r.math.Midpoint2D(t,n);return{x:a.x,y:a.y,dist:r.math.Dist2D(t,n)}}};this.container.on("touchstart mousedown",(function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),r.reader.overview.delta=0,i=!0,o=d(e),clearInterval(r.reader.overview.interval),clearTimeout(r.reader.overview.scrollTimeout)})),this.container.on("touchmove mousemove",(function(t){if(t&&t.preventDefault&&t.preventDefault(),t&&t.stopPropagation&&t.stopPropagation(),i){switch(s=d(t),r.reader.settings.overview_direction){case"left":case"right":r.reader.overview.delta=o.y-s.y,e.container[0].scrollTop+=r.reader.overview.delta;break;case"top":case"bottom":r.reader.overview.delta=o.x-s.x,e.container[0].scrollLeft+=r.reader.overview.delta}o=s}})),this.container.on("touchend mouseup mouseleave",(function(t){if(t&&t.preventDefault&&t.preventDefault(),t&&t.stopPropagation&&t.stopPropagation(),i=!1,Math.abs(r.reader.overview.delta)>=10){l=Math.abs(r.reader.overview.delta)/(r.pager.is_mobile?30:60);var o=function(){if(Math.abs(r.reader.overview.delta)>1){switch(r.reader.settings.overview_direction){case"left":case"right":e.container[0].scrollTop+=r.reader.overview.delta;break;case"top":case"bottom":e.container[0].scrollLeft+=r.reader.overview.delta}r.reader.overview.delta>0?r.reader.overview.delta-=l:r.reader.overview.delta+=l,r.reader.overview.interval=n(o)}else a(r.reader.overview.interval)};r.reader.overview.interval=n(o)}}))}},open:function(){if(this.ensureInit(),this.isFirstOpen){this.isFirstOpen=!1;var e,t=r.pager.getPageSize(1,!0);switch(r.reader.settings.overview_direction){case"left":case"right":e=(r.reader.settings.overview_size-16)/t.width;break;case"top":case"bottom":e=(r.reader.settings.overview_size-16)/t.height}for(var n={width:t.width*e,height:t.height*e},a=0;a<r.pager.page_count;a++){var i=r.e("<div>",{class:"thumb","data-page":a+1}),o=r.reader.stageLoader();o.load([r.pager.getThumbPath(a+1)]),o.appendTo(i),i.setAttr("style","width: {0}px; height: {1}px;".format(n.width,n.height)),i.appendTo(this.container);var s=!1;i.on("mousedown touchstart",(function(){s=!0})),i.on("mouseup touchend",(function(){s&&(r.pager.current_page=parseInt(r.e(this).getAttr("data-page")),r.pager.goToPage(r.pager.current_page),s=!1)})),i.on("mousemove mousecancel touchmove touchcancel",(function(){s=!1}))}}this.container.removeClass("hidden"),r.e("#reader-container .controls").setAttr("style","{0}: {1}px;".format(r.reader.settings.overview_direction,r.reader.settings.overview_size)),r.reader.settings.overview_overlay||r.pager.content_container.setAttr("style","{0}: {1}px;".format(r.reader.settings.overview_direction,r.reader.settings.overview_size)),this.scrollToCurrentPage(),this.isOpen=!0},scrollTimeout:null,scrollToCurrentPage:function(){var e=r.e(".thumb[data-page='{0}']".format(r.pager.current_page_firstvalid)),n=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,a=t.cancelAnimationFrame||t.mozCancelAnimationFrame;if(e&&e.length>0){if(r.e(".thumb").removeClass("active"),r.pager.current_mode==r.pager.constant.SINGLE||r.pager.current_mode==r.pager.constant.SINGLE_REVERSE?e.addClass("active"):r.e(".thumb[data-page='{0}'], .thumb[data-page='{1}']".format(r.pager.current_page_left,r.pager.current_page_right)).addClass("active"),"left"==r.reader.settings.overview_direction||"right"==r.reader.settings.overview_direction)var i=e[0].offsetTop-(e[0].offsetHeight+this.container[0].offsetHeight)/2+e[0].offsetHeight;else i=e[0].offsetLeft-(e[0].offsetWidth+this.container[0].offsetWidth)/2+e[0].offsetWidth;r.pager.current_mode!=r.pager.constant.DOUBLE&&r.pager.current_mode!=r.pager.constant.DOUBLE_REVERSE||(i+=16+("left"==r.reader.settings.overview_direction||"right"==r.reader.settings.overview_direction?e[0].offsetHeight/2:e[0].offsetWidth/2));var o=0,s=(Math.abs(this.container[0].scrollTop-i),this),l=i-this.container[0].scrollTop,d=this.container[0].scrollTop;"top"!=r.reader.settings.overview_direction&&"bottom"!=r.reader.settings.overview_direction||(l=i-this.container[0].scrollLeft,d=this.container[0].scrollLeft);var c=function(e,t,r,n){return(e/=n/2)<1?r/2*e*e+t:-r/2*(--e*(e-2)-1)+t},g=function(){"left"==r.reader.settings.overview_direction||"right"==r.reader.settings.overview_direction?s.container[0].scrollTop=c(o,d,l,60):s.container[0].scrollLeft=c(o,d,l,60),++o<60?s.scrollTimeout=n(g):a(s.scrollTimeout)};a(this.scrollTimeout),this.scrollTimeout=n(g)}},close:function(){this.ensureInit(),this.container.addClass("hidden"),r.pager.content_container.setAttr("style",""),r.e("#reader-container .controls").setAttr("style",""),this.isOpen=!1},toggle:function(){this.isOpen?this.close():this.open()}},prepareData:function(){r.net.request(this.path+"/data.json",{finished:function(e,t){e&&(r.pager.pages=r.jsonParse(t),r.pager.init())}})},prepareCover:function(){var e=this.stageLoader();e.addClass("cover-loader"),e.appendTo(".main-loader"),e.load([this.path+"/cover_small.jpg",this.path+"/cover_medium.jpg",this.path+"/cover_big.jpg"])},prepareElements:function(){for(var e in this.elements)this._prepareElement(this.elements[e],this.container)},_prepareElement:function(e,t){var n,a;if(0==(n=t.find(e.selector)).length&&(n=r.e(e.construct||"<div>",e.options)).appendTo(t),void 0!==e.children)for(a in e.children)this._prepareElement(e.children[a],n);return n},make_slider:function(e,t){var n=r.e("<div>",{class:"slider",value:50}),a=r.e("<div>",{class:"track"}).appendTo(n),i=r.e("<div>",{class:"fill"}).appendTo(a),o=r.e("<div>",{class:"thumb"}).appendTo(n),s=r.e("<div>",{class:"buffer"}),l=null,d=null,c=!1,g={slider:{max:e.max||100,min:e.min||0,value:e.value||50,sigfigs:null!=e.sigfigs?e.sigfigs:-1,dragging:!1,update:function(e,t){var a=g.slider,s=r.math.Percentage.XofY(a.value,a.max);c?(i.setStyle("height",s+"%"),o.setStyle("bottom",s+"%")):(i.setStyle("width",s+"%"),o.setStyle("left",s+"%"));var h=a.value+0;d&&r.is.function(d)&&(h=d(h)),o.setAttr("value",a.value),n.setAttr("value",a.value),n.setAttr("max",a.max),n.setAttr("min",a.min),!e&&l&&r.is.function(l)&&l(a.value,!!t)},set:function(e){var t=g.slider;t.value=e,t.update},setBuffer:function(e){s.setStyle("width",100-e+"%")},onStart:function(){g.slider.dragging=!0,o.addClass("pressed")},onEnd:function(){g.slider.dragging=!1,o.removeClass("pressed")},onDrag:function(e){var t=g.slider;if(t.dragging){var a=t.getPos(e);if(c){var i=n.getHeight();t.value=r.math.Percentage.XofY(i-a.y,i)/100*t.max+t.min}else{var o=n.getWidth();t.value=r.math.Percentage.XofY(a.x,o)/100*t.max+t.min}-1!=t.sigfigs&&(t.value=t.value.toFixed(t.sigfigs)),t.value=Math.min(t.max,Math.max(t.min,t.value)),t.update(void 0,!0)}},getPos:function(e){var t=n.getPageXY();return e.type.startsWith("touch")?1==e.touches.length?{x:e.touches[0].pageX-t.x,y:e.touches[0].pageY-t.y}:void 0:{x:e.pageX-t.x,y:e.pageY-t.y}}}};return e&&(e.dark&&n.addClass("dark"),e.discrete&&n.addClass("discrete"),e.callback&&(l=e.callback),e.displayCallback&&(d=e.displayCallback),e.vertical&&(c=!0),e.buffering&&s.appendTo(a),e.buffer&&g.setBuffer(e.buffer)),c&&n.addClass("vertical"),n.extend(g),n.slider.update(),o.on("mousedown touchstart",g.slider.onStart),n.on("mousemove touchmove",g.slider.onDrag),r.e("body").on("mouseup touchend",g.slider.onEnd),n},stageLoaderId:0,stageLoader:function(){var e=r.e("<div>",{class:"loader"}),t=r.e("<div>",{class:"spinner"}).appendTo(e),n=(++r.reader.stageLoaderId,{currentStage:-1,instanceId:0,sources:[],elements:[],spinner:null,callback:null,loadInstance:null,load:function(t,a,i){if(t){for(var o=!0,s=0;s<t.length;s++)if(t[s]!=n.sources[s]){o=!1;break}if(o)return void(a&&r.is.function(a)&&a());n.sources=t,n.spinner.removeClass("hidden");for(s=0;s<n.elements.length;s++)n.elements[s].remove();n.elements=[];for(s=0;s<n.sources.length;s++)n.elements[s]=r.e("<img>",{class:i&&0==s?"":"loading"}).appendTo(e)}n.callback=a,n.loadInstance=new n.loadEvent(++n.instanceId),n.currentStage=-1,n.loadInstance.onLoad()},loadEvent:function(e){var t=this;this.id=e,this.onLoad=function(){if(t.id==n.instanceId)if(n.currentStage>=0&&(n.spinner.addClass("hidden"),n.elements[n.currentStage]&&n.elements[n.currentStage].removeClass("loading")),n.currentStage++,n.currentStage<n.sources.length)n.elements[n.currentStage].on("load",t.onLoad),n.elements[n.currentStage].setAttr("src",n.sources[n.currentStage]);else if(n.callback&&r.is.function(n.callback)){if(t.id!=n.instanceId)return;n.callback(),n.callback=null}}}});return n.spinner=t,exHelp.extend(e,n),e},isInvertOn:!1,toggleInvert:function(){this.isInvertOn?(r.reader.container.removeClass("invert"),this.isInvertOn=!1):(r.reader.container.addClass("invert"),this.isInvertOn=!0)}},swipe_animator:{listen:!0,dragging:!1,dragged:null,revealed:null,moveStart:null,size:null,last:null,target:null,direction:"none",animationTimeout:null,init:function(){r.e(document).on("mousedown touchstart",this.listenerStart),r.e(document).on("mousemove touchmove",this.listenerMove),r.e(document).on("mouseup touchend mouseleave touchleave",this.listenerEnd)},destruct:function(){r.e(document).off("mousedown touchstart",this.listenerStart),r.e(document).off("mousemove touchmove",this.listenerMove),r.e(document).off("mouseup touchend mouseleave touchleave",this.listenerEnd)},intersects:function(e,t){return e.x>t.left&&e.x<t.right&&e.y>t.top&&e.y<t.bottom},posFromEvent:function(e){if(!e.type.startsWith("touch"))return{x:e.pageX,y:e.pageY};if(1==e.touches.length)return{x:e.touches[0].pageX,y:e.touches[0].pageY};if(2==e.touches.length){var t={x:e.touches[0].pageX,y:e.touches[0].pageY},n={x:e.touches[1].pageX,y:e.touches[1].pageY},a=r.math.Midpoint2D(t,n);return{x:a.x,y:a.y,dist:r.math.Dist2D(t,n)}}},animateRight:function(e){var t=r.swipe_animator,n=r.pager.constant,a=r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?2*t.size.width:t.size.width,i=Math.min(1,e/a),o=r.math.easing.easeOutQuad(100*i,0,100,100)/100;clearTimeout(t.animationTimeout),r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?(t.revealed=r.e([r.pager.holders[n.CUR_LEFT],r.pager.holders[n.CUR_RIGHT]]),t.dragged=r.e([r.pager.holders[n.NEXT_LEFT],r.pager.holders[n.NEXT_RIGHT]]),r.e([r.pager.holders[n.PREV_LEFT],r.pager.holders[n.PREV_LEFT]]).addClass("hidden"),r.pager.showPage(r.pager.current_page_left+2)?r.e(r.pager.holders[n.NEXT_LEFT]).removeClass("hidden"):r.e(r.pager.holders[n.NEXT_LEFT]).addClass("hidden"),r.pager.showPage(r.pager.current_page_right+2)?r.e(r.pager.holders[n.NEXT_RIGHT]).removeClass("hidden"):r.e(r.pager.holders[n.NEXT_RIGHT]).addClass("hidden"),r.pager.showPage(r.pager.current_page_left)?r.e(r.pager.holders[n.CUR_LEFT]).removeClass("hidden"):r.e(r.pager.holders[n.CUR_LEFT]).addClass("hidden"),r.pager.showPage(r.pager.current_page_right)?r.e(r.pager.holders[n.CUR_RIGHT]).removeClass("hidden"):r.e(r.pager.holders[n.CUR_RIGHT]).addClass("hidden")):(t.revealed=r.pager.holders[n.CUR],t.dragged=r.pager.holders[n.NEXT],r.pager.holders[n.PREV].addClass("hidden"),r.pager.holders[n.NEXT].removeClass("hidden")),t.dragged.addClass("animate"),t.revealed.addClass("wait"),r.overlays.setHidden(!0),t.dragged.setStyle("transform","translate({0}px, 0)".format(a-a*o)),t.revealed.setStyle("transform","translate(-{0}%, 0)".format(20*o)),t.dragged.setStyle("opacity",1*r.math.easing.easeOutExpo(1e3*i,0,1,100)),t.revealed.setStyle("opacity",10-r.math.easing.easeOutExpo(100*i,0,10,100))},animateLeft:function(e){var t=r.swipe_animator,n=r.pager.constant,a=r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?2*t.size.width:t.size.width,i=Math.min(1,e/a),o=r.math.easing.easeOutQuad(100*i,0,100,100)/100;clearTimeout(t.animationTimeout),r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?(t.revealed=r.e([r.pager.holders[n.CUR_LEFT],r.pager.holders[n.CUR_RIGHT]]),t.dragged=r.e([r.pager.holders[n.PREV_LEFT],r.pager.holders[n.PREV_RIGHT]]),r.e([r.pager.holders[n.NEXT_LEFT],r.pager.holders[n.NEXT_RIGHT]]).addClass("hidden")):(t.dragged=r.pager.holders[n.PREV],t.revealed=r.pager.holders[n.CUR],r.pager.holders[n.PREV].removeClass("hidden"),r.pager.holders[n.NEXT].addClass("hidden")),t.dragged.addClass("animate").removeClass("hidden"),t.revealed.addClass("wait").removeClass("hidden"),r.overlays.setHidden(!0),t.dragged.setStyle("transform","translate(-{0}px, 0)".format(a-a*o)),t.revealed.setStyle("transform","translate({0}%, 0)".format(20*o)),t.dragged.setStyle("opacity",1*r.math.easing.easeOutExpo(1e3*i,0,1,100)),t.revealed.setStyle("opacity",10-r.math.easing.easeOutExpo(100*i,0,10,100))},animateRightTo:function(e,n,a){var i=r.swipe_animator,o=(r.pager.constant,0),s=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,l=t.cancelAnimationFrame||t.mozCancelAnimationFrame,d=function(){i.animateRight(r.math.easing.easeInOutQuad(o++,e,n-e,30)),o<30?i.animationTimeout=s(d):r.is.function(a)&&(a(),l(i.animationTimeout))};l(i.animationTimeout),i.animationTimeout=s(d)},animateLeftTo:function(e,n,a){var i=r.swipe_animator,o=(r.pager.constant,0),s=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,l=t.cancelAnimationFrame||t.mozCancelAnimationFrame,d=function(){i.animateLeft(r.math.easing.easeInOutQuad(o++,e,n-e,30)),o<30?i.animationTimeout=s(d):r.is.function(a)&&(a(),l(i.animationTimeout))};l(i.animationTimeout),i.animationTimeout=s(d)},listenerStart:function(e){var t=r.swipe_animator,n=r.pager.constant;if(!t.lockAnimation&&!r.pager.touchBlocked&&r.pager.current_animation==n.SWIPE)if(r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE){var a=r.pager.holders[n.CUR_LEFT][0].getBoundingClientRect(),i=r.pager.holders[n.CUR_RIGHT][0].getBoundingClientRect(),o={top:a.top,left:a.left,right:a.left+.1*a.width,bottom:a.bottom},s={top:i.top,left:i.right-.1*i.width,right:i.right,bottom:i.bottom},l=t.posFromEvent(e);t.intersects(l,s)?(t.size={width:a.width||i.width,height:a.height||i.height},t.target=r.pager.page_container[0].getBoundingClientRect(),t.target={top:t.target.top+r.pager.current_padding,left:t.target.left+r.pager.current_padding,right:t.target.right-r.pager.current_padding,bottom:t.target.bottom-r.pager.current_padding},t.moveStart=l,r.pager.paging_handled_by_animator=!0,t.startDragRight()):t.intersects(l,o)&&(t.size={width:a.width||i.width,height:a.height||i.height},t.target=r.pager.page_container[0].getBoundingClientRect(),t.target={top:t.target.top+r.pager.current_padding,left:t.target.left+r.pager.current_padding,right:t.target.right-r.pager.current_padding,bottom:t.target.bottom-r.pager.current_padding},t.moveStart=l,r.pager.paging_handled_by_animator=!0,t.startDragLeft())}else{var d=r.pager.holders[n.CUR][0].getBoundingClientRect();o={top:d.top,left:d.left,right:d.left+.1*d.width,bottom:d.bottom},s={top:d.top,left:d.right-.1*d.width,right:d.right,bottom:d.bottom},l=t.posFromEvent(e);t.size={width:d.width,height:d.height},t.target=r.pager.page_container[0].getBoundingClientRect(),t.target={top:t.target.top+r.pager.current_padding,left:t.target.left+r.pager.current_padding,right:t.target.right-r.pager.current_padding,bottom:t.target.bottom-r.pager.current_padding},t.moveStart=l,t.intersects(l,s)?(r.pager.paging_handled_by_animator=!0,t.startDragRight()):t.intersects(l,o)&&(r.pager.paging_handled_by_animator=!0,t.startDragLeft())}},listenerMove:function(e){var t=r.swipe_animator;r.pager.constant;if(!t.lockAnimation&&t.dragging){var n=t.posFromEvent(e);if(t.last=n,"right"==t.direction){var a=Math.abs(t.target.right-n.x);t.animateRight(a)}else if("left"==t.direction){a=Math.abs(t.target.left-n.x);t.animateLeft(a)}}},listenerEnd:function(e){var t=r.swipe_animator,n=r.pager.constant;if(!t.lockAnimation&&t.dragging){r.reader.playPageSound();var a=t.last,i=function(){t.dragged.removeClass("animate"),t.revealed.removeClass("wait"),t.dragged.setStyle("transform",""),t.revealed.setStyle("transform",""),r.pager.paging_handled_by_animator=!1,t.last=null,t.lockAnimation=!1,r.overlays.setHidden(!1)};if("right"==t.direction){var o=null!=a?Math.abs(t.target.right-a.x):0,s=(l=r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?2*t.size.width:t.size.width)/10;o<l?o>=s?t.animateRightTo(o,l,(function(){r.pager.goForward((function(){i()}))})):t.animateRightTo(o,0,(function(){i()})):r.pager.goForward((function(){i()}))}else if("left"==t.direction){var l;o=null!=a?Math.abs(t.target.left-a.x):0,s=(l=r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?2*t.size.width:t.size.width)/8;o<l?o>=s?t.animateLeftTo(o,l,(function(){r.pager.goBack((function(){i()}))})):t.animateLeftTo(o,0,(function(){i()})):r.pager.goBack((function(){i()}))}}t.dragging=!1},lockAnimation:!1,doFullAnimationNext:function(e){var t=r.swipe_animator,n=r.pager.constant;if(!t.lockAnimation&&r.pager.can_go_forward){t.lockAnimation=!0,r.reader.playPageSound();t.last;var a=r.pager.holders[n.CUR_LEFT][0].getBoundingClientRect(),i=r.pager.holders[n.CUR_RIGHT][0].getBoundingClientRect();t.size={width:a.width||i.width,height:a.height||i.height},t.target=r.pager.page_container[0].getBoundingClientRect(),t.target={top:t.target.top+r.pager.current_padding,left:t.target.left+r.pager.current_padding,right:t.target.right-r.pager.current_padding,bottom:t.target.bottom-r.pager.current_padding};var o=r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?2*t.size.width:t.size.width;t.direction="right",t.animateRightTo(0,o,(function(){r.pager.goForward(null,(function(){t.dragged.removeClass("animate"),t.revealed.removeClass("wait"),t.dragged.setStyle("transform",""),t.revealed.setStyle("transform",""),e&&r.is.function(e)&&e(),t.lockAnimation=!1,r.pager.paging_handled_by_animator=!1,t.last=null,r.overlays.setHidden(!1)}))}))}},doFullAnimationPrev:function(e){var t=r.swipe_animator,n=r.pager.constant;if(!t.lockAnimation&&r.pager.can_go_back){t.lockAnimation=!0,r.reader.playPageSound();t.last;var a=r.pager.holders[n.CUR_LEFT][0].getBoundingClientRect(),i=r.pager.holders[n.CUR_RIGHT][0].getBoundingClientRect();t.size={width:a.width||i.width,height:a.height||i.height},t.target=r.pager.page_container[0].getBoundingClientRect(),t.target={top:t.target.top+r.pager.current_padding,left:t.target.left+r.pager.current_padding,right:t.target.right-r.pager.current_padding,bottom:t.target.bottom-r.pager.current_padding};var o=r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?2*t.size.width:t.size.width;t.direction="left",t.animateLeftTo(0,o,(function(){r.pager.goBack(null,(function(){t.dragged.removeClass("animate"),t.revealed.removeClass("wait"),t.dragged.setStyle("transform",""),t.revealed.setStyle("transform",""),e&&r.is.function(e)&&e(),t.lockAnimation=!1,r.pager.paging_handled_by_animator=!1,t.last=null,r.overlays.setHidden(!1)}))}))}},startDragRight:function(e){var n=r.swipe_animator,a=r.pager.constant,i=t.cancelAnimationFrame||t.mozCancelAnimationFrame;n.dragging=!0,i(n.animationTimeout),r.pager.current_mode==a.DOUBLE||r.pager.current_mode==a.DOUBLE_REVERSE?(n.revealed=r.e([r.pager.holders[a.CUR_LEFT],r.pager.holders[a.CUR_RIGHT]]),n.dragged=r.e([r.pager.holders[a.NEXT_LEFT],r.pager.holders[a.NEXT_RIGHT]]),r.e([r.pager.holders[a.PREV_LEFT],r.pager.holders[a.PREV_LEFT]]).addClass("hidden"),r.pager.showPage(r.pager.current_page_left+2)?r.e(r.pager.holders[a.NEXT_LEFT]).removeClass("hidden"):r.e(r.pager.holders[a.NEXT_LEFT]).addClass("hidden"),r.pager.showPage(r.pager.current_page_right+2)?r.e(r.pager.holders[a.NEXT_RIGHT]).removeClass("hidden"):r.e(r.pager.holders[a.NEXT_RIGHT]).addClass("hidden"),r.pager.showPage(r.pager.current_page_left)?r.e(r.pager.holders[a.CUR_LEFT]).removeClass("hidden"):r.e(r.pager.holders[a.CUR_LEFT]).addClass("hidden"),r.pager.showPage(r.pager.current_page_right)?r.e(r.pager.holders[a.CUR_RIGHT]).removeClass("hidden"):r.e(r.pager.holders[a.CUR_RIGHT]).addClass("hidden")):(n.revealed=r.pager.holders[a.CUR],n.dragged=r.pager.holders[a.NEXT],r.pager.holders[a.PREV].addClass("hidden")),n.dragged.addClass("animate"),n.revealed.addClass("wait"),n.dragged.setStyle("transform","translate(200%, 0)"),n.revealed.setStyle("transform","translate(0%, 0)"),n.direction="right"},startDragLeft:function(e){var n=r.swipe_animator,a=r.pager.constant,i=t.cancelAnimationFrame||t.mozCancelAnimationFrame;n.dragging=!0,i(n.animationTimeout),r.pager.current_mode==a.DOUBLE||r.pager.current_mode==a.DOUBLE_REVERSE?(n.revealed=r.e([r.pager.holders[a.CUR_LEFT],r.pager.holders[a.CUR_RIGHT]]),n.dragged=r.e([r.pager.holders[a.PREV_LEFT],r.pager.holders[a.PREV_RIGHT]]),r.e([r.pager.holders[a.NEXT_LEFT],r.pager.holders[a.NEXT_RIGHT]]).addClass("hidden")):(n.dragged=r.pager.holders[a.PREV],n.revealed=r.pager.holders[a.CUR],r.pager.holders[a.NEXT].addClass("hidden")),n.dragged.addClass("animate").removeClass("hidden"),n.revealed.addClass("wait").removeClass("hidden"),n.dragged.setStyle("transform","translate(-200%, 0)"),n.revealed.setStyle("transform","translate(0%, 0)"),n.direction="left"}},flip_animator:{listen:!0,dragging:!1,dragged:null,revealed:null,hidden:null,fullhidden:null,moveStart:null,size:null,last:null,target:null,direction:"none",animationTimeout:null,init:function(){r.e(document).on("mousedown touchstart",this.listenerStart),r.e(document).on("mousemove touchmove",this.listenerMove),r.e(document).on("mouseup touchend mouseleave touchleave",this.listenerEnd)},destruct:function(){r.e(document).off("mousedown touchstart",this.listenerStart),r.e(document).off("mousemove touchmove",this.listenerMove),r.e(document).off("mouseup touchend mouseleave touchleave",this.listenerEnd)},intersects:function(e,t){return e.x>t.left&&e.x<t.right&&e.y>t.top&&e.y<t.bottom},posFromEvent:function(e){if(!e.type.startsWith("touch"))return{x:e.pageX,y:e.pageY};if(1==e.touches.length)return{x:e.touches[0].pageX,y:e.touches[0].pageY};if(2==e.touches.length){var t={x:e.touches[0].pageX,y:e.touches[0].pageY},n={x:e.touches[1].pageX,y:e.touches[1].pageY},a=r.math.Midpoint2D(t,n);return{x:a.x,y:a.y,dist:r.math.Dist2D(t,n)}}},animateRight:function(e){var t=r.flip_animator,n=r.pager.constant;t.dragged.addClass("animate"),t.revealed.addClass("wait"),r.overlays.setHidden(!0),r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?(r.pager.showPage(r.pager.current_page_left+2)?t.dragged.removeClass("hidden"):t.dragged.addClass("hidden"),r.pager.showPage(r.pager.current_page_right+2)?t.revealed.removeClass("hidden"):t.revealed.addClass("hidden"),t.fullhidden.addClass("hidden"),t.dragged.setStyle("left","auto"),t.revealed.setStyle("left","auto"),t.revealed.setStyle("right",r.pager.current_padding+"px"),t.revealed.find(".wrapper").setStyle("left","auto"),t.revealed.find(".wrapper").setStyle("width",t.size.width+"px"),t.dragged.find(".wrapper").setStyle("right","auto"),t.dragged.find(".wrapper").setStyle("width",t.size.width+"px"),t.hidden.find(".wrapper").setStyle("right","auto"),t.hidden.find(".wrapper").setStyle("width",t.size.width+"px"),t.dragged.setStyle("right",Math.min(r.pager.current_padding+e/2,t.size.width+r.pager.current_padding)+"px"),t.dragged.setStyle("width",Math.min(e/2,t.size.width)+"px"),t.hidden.setStyle("width",Math.max(0,t.size.width-e)+"px"),t.revealed.setStyle("width",Math.min(e/2,t.size.width)+"px")):(r.pager.showPage(r.pager.current_page+1)&&t.revealed.removeClass("hidden"),t.dragged.find(".wrapper").setStyle("left","auto"),t.dragged.find(".wrapper").setStyle("width",t.size.width+"px"),t.dragged.setStyle("right",Math.min(r.pager.current_padding+e,t.size.width+r.pager.current_padding)+"px"),t.dragged.setStyle("width",Math.max(t.size.width-e,0)+"px"))},animateLeft:function(e){var t=r.flip_animator,n=r.pager.constant;t.dragged.addClass("animate"),t.revealed.addClass("wait"),r.overlays.setHidden(!0),r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?(r.pager.showPage(r.pager.current_page_left-2)?t.revealed.removeClass("hidden"):t.revealed.addClass("hidden"),r.pager.showPage(r.pager.current_page_right-2)?t.dragged.removeClass("hidden"):t.dragged.addClass("hidden"),t.dragged.setStyle("right","auto"),t.dragged.find(".wrapper").setStyle("left","auto"),t.dragged.find(".wrapper").setStyle("width",t.size.width+"px"),t.revealed.find(".wrapper").setStyle("right","auto"),t.revealed.find(".wrapper").setStyle("width",t.size.width+"px"),t.hidden.find(".wrapper").setStyle("left","auto"),t.hidden.find(".wrapper").setStyle("width",t.size.width+"px"),t.revealed.setStyle("right","auto"),t.revealed.setStyle("left",r.pager.current_padding+"px"),t.dragged.setStyle("left",Math.min(r.pager.current_padding+e/2,t.size.width+r.pager.current_padding)+"px"),t.dragged.setStyle("width",Math.min(e/2,t.size.width)+"px"),t.hidden.setStyle("width",Math.max(0,t.size.width-e)+"px"),t.revealed.setStyle("width",Math.min(e/2,t.size.width)+"px")):(r.pager.showPage(r.pager.current_page-1)?t.revealed.removeClass("hidden"):t.revealed.addClass("hidden"),t.dragged.setStyle("right",r.pager.current_padding+"px"),t.dragged.find(".wrapper").setStyle("left","auto"),t.dragged.find(".wrapper").setStyle("width",t.size.width+"px"),t.revealed.find(".wrapper").setStyle("left","auto"),t.revealed.find(".wrapper").setStyle("width",t.size.width+"px"),t.dragged.setStyle("left",Math.min(r.pager.current_padding+e,t.size.width+r.pager.current_padding)+"px"),t.dragged.setStyle("width",Math.max(0,t.size.width-e)+"px"),t.revealed.setStyle("width",Math.min(e,t.size.width)+"px"))},animateRightTo:function(e,n,a){var i=r.flip_animator,o=(r.pager.constant,0),s=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,l=t.cancelAnimationFrame||t.mozCancelAnimationFrame,d=function(){i.animateRight(r.math.easing.easeInOutQuad(o++,e,n-e,30)),o<30?i.animationTimeout=s(d):r.is.function(a)&&(a(),l(i.animationTimeout))};l(i.animationTimeout),i.animationTimeout=s(d)},animateLeftTo:function(e,n,a){var i=r.flip_animator,o=(r.pager.constant,0),s=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,l=t.cancelAnimationFrame||t.mozCancelAnimationFrame,d=function(){i.animateLeft(r.math.easing.easeInOutQuad(o++,e,n-e,30)),o<30?i.animationTimeout=s(d):r.is.function(a)&&(a(),l(i.animationTimeout))};l(i.animationTimeout),i.animationTimeout=s(d)},listenerStart:function(e){var t=r.flip_animator,n=r.pager.constant;if(!t.lockAnimation&&!r.pager.touchBlocked&&r.pager.current_animation==n.FLIP)if(r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE){var a=r.pager.holders[n.CUR_LEFT][0].getBoundingClientRect(),i=r.pager.holders[n.CUR_RIGHT][0].getBoundingClientRect(),o={top:a.top,left:a.left,right:a.left+.1*a.width,bottom:a.bottom},s={top:i.top,left:i.right-.1*i.width,right:i.right,bottom:i.bottom},l=t.posFromEvent(e);t.intersects(l,s)&&r.pager.showPage(r.pager.current_page_left+2)?(t.size={width:a.width||i.width,height:a.height||i.height},t.target=r.pager.page_container[0].getBoundingClientRect(),t.target={top:t.target.top+r.pager.current_padding,left:t.target.left+r.pager.current_padding,right:t.target.right-r.pager.current_padding,bottom:t.target.bottom-r.pager.current_padding},t.moveStart=l,r.pager.paging_handled_by_animator=!0,t.startDragRight()):t.intersects(l,o)&&r.pager.showPage(r.pager.current_page_right-2)&&(t.size={width:a.width||i.width,height:a.height||i.height},t.target=r.pager.page_container[0].getBoundingClientRect(),t.target={top:t.target.top+r.pager.current_padding,left:t.target.left+r.pager.current_padding,right:t.target.right-r.pager.current_padding,bottom:t.target.bottom-r.pager.current_padding},t.moveStart=l,r.pager.paging_handled_by_animator=!0,t.startDragLeft())}else{var d=r.pager.holders[n.CUR][0].getBoundingClientRect();o={top:d.top,left:d.left,right:d.left+.1*d.width,bottom:d.bottom},s={top:d.top,left:d.right-.1*d.width,right:d.right,bottom:d.bottom},l=t.posFromEvent(e);t.size={width:d.width,height:d.height},t.target=r.pager.page_container[0].getBoundingClientRect(),t.target={top:t.target.top+r.pager.current_padding,left:t.target.left+r.pager.current_padding,right:t.target.right-r.pager.current_padding,bottom:t.target.bottom-r.pager.current_padding},t.moveStart=l,t.intersects(l,s)&&r.pager.showPage(r.pager.current_page+1)?(r.pager.paging_handled_by_animator=!0,t.startDragRight()):t.intersects(l,o)&&r.pager.showPage(r.pager.current_page-1)&&(r.pager.paging_handled_by_animator=!0,t.startDragLeft())}},listenerMove:function(e){var t=r.flip_animator;r.pager.constant;if(!t.lockAnimation&&t.dragging){var n=t.posFromEvent(e);if(t.last=n,"right"==t.direction){var a=Math.abs(t.target.right-n.x);t.animateRight(a)}else if("left"==t.direction){a=Math.abs(t.target.left-n.x);t.animateLeft(a)}}},listenerEnd:function(e){var t=r.flip_animator,n=r.pager.constant;if(!t.lockAnimation&&t.dragging){r.reader.playPageSound();var a=t.last,i=function(){t.dragged.removeClass("animate"),t.revealed.removeClass("wait"),t.dragged.find(".wrapper").setAttr("style",""),t.revealed.find(".wrapper").setAttr("style",""),t.hidden.find(".wrapper").setAttr("style",""),t.dragged.find(".loader").setAttr("style",""),t.revealed.find(".loader").setAttr("style",""),r.pager.paging_handled_by_animator=!1,t.last=null,t.lockAnimation=!1,r.overlays.setHidden(!1)};if("right"==t.direction){var o=null!=a?Math.abs(t.target.right-a.x):0,s=(l=r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?2*t.size.width:t.size.width)/10;o<l?o>=s?t.animateRightTo(o,l,(function(){r.pager.goForward(null,(function(){i()}))})):t.animateRightTo(o,0,(function(){i()})):r.pager.goForward(null,(function(){i()}))}else if("left"==t.direction){var l;o=null!=a?Math.abs(t.target.left-a.x):0,s=(l=r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?2*t.size.width:t.size.width)/10;o<l?o>=s?t.animateLeftTo(o,l,(function(){r.pager.goBack((function(){i()}))})):t.animateLeftTo(o,0,(function(){i()})):r.pager.goBack((function(){i()}))}}t.dragging=!1},lockAnimation:!1,doFullAnimationNext:function(e){var t=r.flip_animator,n=r.pager.constant;if(!t.lockAnimation&&r.pager.can_go_forward){t.lockAnimation=!0,r.reader.playPageSound();t.last;if(r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE){var a=r.pager.holders[n.CUR_LEFT][0].getBoundingClientRect(),i=r.pager.holders[n.CUR_RIGHT][0].getBoundingClientRect();t.size={width:a.width||i.width,height:a.height||i.height}}else{var o=r.pager.holders[n.CUR][0].getBoundingClientRect();t.size={width:o.width,height:o.height}}t.target=r.pager.page_container[0].getBoundingClientRect(),t.target={top:t.target.top+r.pager.current_padding,left:t.target.left+r.pager.current_padding,right:t.target.right-r.pager.current_padding,bottom:t.target.bottom-r.pager.current_padding};var s=r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?2*t.size.width:t.size.width;r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?(t.dragged=r.pager.holders[n.NEXT_LEFT],t.revealed=r.pager.holders[n.NEXT_RIGHT],t.hidden=r.pager.holders[n.CUR_RIGHT],t.fullhidden=r.e([r.pager.holders[n.PREV_LEFT],r.pager.holders[n.PREV_RIGHT]]),r.pager.showPage(r.pager.current_page_left+2)&&t.dragged.removeClass("hidden"),r.pager.showPage(r.pager.current_page_right+2)&&t.revealed.removeClass("hidden"),t.fullhidden.addClass("hidden")):(t.dragged=r.pager.holders[n.CUR],t.revealed=r.pager.holders[n.NEXT],t.hidden=r.e(),t.fullhidden=r.pager.holders[n.PREV],r.pager.showPage(r.pager.current_page+1)&&t.revealed.removeClass("hidden")),t.dragged.addClass("animate"),t.revealed.addClass("wait"),r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?(t.dragged.setStyle("left","auto"),t.dragged.setStyle("right",r.pager.current_padding+"px"),t.dragged.setStyle("width","0px"),t.revealed.setStyle("left","auto"),t.revealed.setStyle("right",r.pager.current_padding+"px"),t.revealed.setStyle("width","0px"),t.revealed.find(".wrapper").setStyle("left","auto"),t.revealed.find(".wrapper").setStyle("width",t.size.width+"px")):(t.dragged.setStyle("right",r.pager.current_padding+"px"),t.dragged.setStyle("width",t.size.width),t.dragged.find(".wrapper").setStyle("left","auto"),t.dragged.find(".wrapper").setStyle("width",t.size.width+"px")),t.direction="right",t.animateRightTo(0,s,(function(){r.pager.goForward(null,(function(){t.dragged.removeClass("animate"),t.revealed.removeClass("wait"),t.dragged.find(".wrapper").setAttr("style",""),t.revealed.find(".wrapper").setAttr("style",""),t.hidden.find(".wrapper").setAttr("style",""),t.dragged.find(".loader").setAttr("style",""),t.revealed.find(".loader").setAttr("style",""),e&&r.is.function(e)&&e(),t.lockAnimation=!1,r.pager.paging_handled_by_animator=!1,t.last=null,r.overlays.setHidden(!1)}))}))}},doFullAnimationPrev:function(e){var t=r.flip_animator,n=r.pager.constant;if(!t.lockAnimation&&r.pager.can_go_back){t.lockAnimation=!0,r.reader.playPageSound();t.last;if(r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE){var a=r.pager.holders[n.CUR_LEFT][0].getBoundingClientRect(),i=r.pager.holders[n.CUR_RIGHT][0].getBoundingClientRect();t.size={width:a.width||i.width,height:a.height||i.height}}else{var o=r.pager.holders[n.CUR][0].getBoundingClientRect();t.size={width:o.width,height:o.height}}t.target=r.pager.page_container[0].getBoundingClientRect(),t.target={top:t.target.top+r.pager.current_padding,left:t.target.left+r.pager.current_padding,right:t.target.right-r.pager.current_padding,bottom:t.target.bottom-r.pager.current_padding};var s=r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?2*t.size.width:t.size.width;r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?(t.dragged=r.pager.holders[n.PREV_RIGHT],t.revealed=r.pager.holders[n.PREV_LEFT],t.hidden=r.pager.holders[n.CUR_LEFT],t.fullhidden=r.e([r.pager.holders[n.NEXT_LEFT],r.pager.holders[n.NEXT_RIGHT]]),r.pager.showPage(r.pager.current_page_left-2)&&t.revealed.removeClass("hidden"),r.pager.showPage(r.pager.current_page_right-2)&&t.dragged.removeClass("hidden"),t.fullhidden.addClass("hidden")):(t.dragged=r.pager.holders[n.CUR],t.revealed=r.pager.holders[n.PREV],t.hidden=r.e(),t.fullhidden=r.pager.holders[n.NEXT],r.pager.showPage(r.pager.current_page-1)&&t.revealed.removeClass("hidden"),t.dragged.removeClass("hidden")),t.dragged.addClass("animate"),t.revealed.addClass("wait"),r.pager.current_mode==n.DOUBLE||r.pager.current_mode==n.DOUBLE_REVERSE?(t.dragged.setStyle("right","auto"),t.dragged.setStyle("left",r.pager.current_padding+"px"),t.dragged.setStyle("width","0px"),t.dragged.find(".wrapper").setStyle("left","auto"),t.dragged.find(".wrapper").setStyle("width",t.size.width+"px"),t.revealed.setStyle("right","auto"),t.revealed.setStyle("left",r.pager.current_padding+"px"),t.revealed.setStyle("width","0px")):(t.dragged.setStyle("right",r.pager.current_padding+"px"),t.dragged.find(".wrapper").setStyle("left","auto"),t.dragged.find(".wrapper").setStyle("width",t.size.width+"px"),t.revealed.find(".wrapper").setStyle("left","auto"),t.revealed.find(".wrapper").setStyle("width",t.size.width+"px")),t.direction="left",t.animateLeftTo(0,s,(function(){r.pager.goBack(null,(function(){t.dragged.removeClass("animate"),t.revealed.removeClass("wait"),t.dragged.find(".wrapper").setAttr("style",""),t.revealed.find(".wrapper").setAttr("style",""),t.hidden.find(".wrapper").setAttr("style",""),t.dragged.find(".loader").setAttr("style",""),t.revealed.find(".loader").setAttr("style",""),e&&r.is.function(e)&&e(),t.lockAnimation=!1,r.pager.paging_handled_by_animator=!1,t.last=null,r.overlays.setHidden(!1)}))}))}},startDragRight:function(e){var n=r.flip_animator,a=r.pager.constant,i=(t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,t.cancelAnimationFrame||t.mozCancelAnimationFrame);n.dragging=!0,i(n.animationTimeout),r.pager.current_mode==a.DOUBLE||r.pager.current_mode==a.DOUBLE_REVERSE?(n.dragged=r.pager.holders[a.NEXT_LEFT],n.revealed=r.pager.holders[a.NEXT_RIGHT],n.hidden=r.pager.holders[a.CUR_RIGHT],n.fullhidden=r.e([r.pager.holders[a.PREV_LEFT],r.pager.holders[a.PREV_RIGHT]]),r.pager.showPage(r.pager.current_page_left+2)&&n.dragged.removeClass("hidden"),r.pager.showPage(r.pager.current_page_right+2)&&n.revealed.removeClass("hidden"),n.fullhidden.addClass("hidden")):(n.dragged=r.pager.holders[a.CUR],n.revealed=r.pager.holders[a.NEXT],n.hidden=r.e(),n.fullhidden=r.pager.holders[a.PREV],r.pager.showPage(r.pager.current_page+1)&&n.revealed.removeClass("hidden")),n.dragged.addClass("animate"),n.revealed.addClass("wait"),r.pager.current_mode==a.DOUBLE||r.pager.current_mode==a.DOUBLE_REVERSE?(n.dragged.setStyle("left","auto"),n.dragged.setStyle("right",r.pager.current_padding+"px"),n.dragged.setStyle("width","0px"),n.revealed.setStyle("left","auto"),n.revealed.setStyle("right",r.pager.current_padding+"px"),n.revealed.setStyle("width","0px"),n.revealed.find(".wrapper").setStyle("left","auto"),n.revealed.find(".wrapper").setStyle("width",n.size.width+"px")):(n.dragged.setStyle("right",r.pager.current_padding+"px"),n.dragged.setStyle("width",n.size.width),n.dragged.find(".wrapper").setStyle("left","auto"),n.dragged.find(".wrapper").setStyle("width",n.size.width+"px")),n.direction="right"},startDragLeft:function(e){var n=r.flip_animator,a=r.pager.constant,i=(t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,t.cancelAnimationFrame||t.mozCancelAnimationFrame);n.dragging=!0,i(n.animationTimeout),r.pager.current_mode==a.DOUBLE||r.pager.current_mode==a.DOUBLE_REVERSE?(n.dragged=r.pager.holders[a.PREV_RIGHT],n.revealed=r.pager.holders[a.PREV_LEFT],n.hidden=r.pager.holders[a.CUR_LEFT],n.fullhidden=r.e([r.pager.holders[a.NEXT_LEFT],r.pager.holders[a.NEXT_RIGHT]]),r.pager.showPage(r.pager.current_page_left-2)&&n.revealed.removeClass("hidden"),r.pager.showPage(r.pager.current_page_right-2)&&n.dragged.removeClass("hidden"),n.fullhidden.addClass("hidden")):(n.dragged=r.pager.holders[a.CUR],n.revealed=r.pager.holders[a.PREV],n.hidden=r.e(),n.fullhidden=r.pager.holders[a.NEXT],r.pager.showPage(r.pager.current_page-1)&&n.revealed.removeClass("hidden"),n.dragged.removeClass("hidden")),n.dragged.addClass("animate"),n.revealed.addClass("wait"),r.pager.current_mode==a.DOUBLE||r.pager.current_mode==a.DOUBLE_REVERSE?(n.dragged.setStyle("right","auto"),n.dragged.setStyle("left",r.pager.current_padding+"px"),n.dragged.setStyle("width","0px"),n.dragged.find(".wrapper").setStyle("left","auto"),n.dragged.find(".wrapper").setStyle("width",n.size.width+"px"),n.revealed.setStyle("right","auto"),n.revealed.setStyle("left",r.pager.current_padding+"px"),n.revealed.setStyle("width","0px")):(n.dragged.setStyle("right",r.pager.current_padding+"px"),n.dragged.find(".wrapper").setStyle("left","auto"),n.dragged.find(".wrapper").setStyle("width",n.size.width+"px"),n.revealed.find(".wrapper").setStyle("left","auto"),n.revealed.find(".wrapper").setStyle("width",n.size.width+"px")),n.direction="left"}},overlays:{elements:[],objects:[],container:null,lastRenderPage:-1,lastRenderZoom:-1,lastRenderMode:-1,init:function(){this.container=r.e("#reader-container .overlayer");for(var e=r.reader.container.find(".overlay"),t=0,n=e.length;t<n;t++)this.parse(e[t]);e.remove()},setHidden:function(e){var t=r.overlays;e?t.container.addClass("hidden"):t.container.removeClass("hidden")},parse:function(e){var t=r.e(e),n={html:t.getHtml().trim(),display:t.getAttr("data-display"),type:t.getAttr("data-type"),x:parseInt(t.getAttr("data-x")),y:parseInt(t.getAttr("data-y")),width:parseInt(t.getAttr("data-width")),height:parseInt(t.getAttr("data-height")),page:parseInt(t.getAttr("data-page")),openWidth:parseInt(t.getAttr("data-open-width")),openHeight:parseInt(t.getAttr("data-open-height")),icon:t.getAttr("data-icon")};this.elements.push(n)},render:function(){var e=r.overlays,t=0,n=e.elements.length,a=r.pager.constant,i=r.pager;if(e.lastRenderMode!=i.current_mode||e.lastRenderPage!=i.current_page||e.lastRenderZoom!=i.current_zoom){if(e.lastRenderMode=i.current_mode,e.lastRenderPage=i.current_page,e.lastRenderZoom=i.current_zoom,e.prepare(),e.objects=[],r.pager.current_mode==a.SINGLE)var o=e.container.find(".page");else if(r.pager.current_mode==a.DOUBLE)var s=e.container.find(".left"),l=e.container.find(".right");for(;t<n;t++){var d,c=e.elements[t];r.pager.current_mode==a.SINGLE?c.page==r.pager.current_page&&(d=e.make(c).appendTo(o)):r.pager.current_mode==a.DOUBLE&&(c.page==r.pager.current_page_left?d=e.make(c).appendTo(s):c.page==r.pager.current_page_right&&(d=e.make(c).appendTo(l))),d&&e.objects.push(d)}}},getAvailableSpace:function(){var e=r.math.rect(r.pager.content_container[0].scrollTop,r.pager.content_container[0].scrollLeft,r.reader.container.getHeight()+r.pager.content_container[0].scrollTop,r.reader.container.getWidth()+r.pager.content_container[0].scrollLeft),t=!1,n=!1,a=!1,i=!1;return r.e("#reader-container .controls .top, #reader-container .controls .topleft .horizontal, #reader-container .controls .topright .horizontal").children().length>0&&(t=!0),r.e("#reader-container .controls .left, #reader-container .controls .topleft .vertical, #reader-container .controls .bottomleft .vertical").children().length>0&&(n=!0),r.e("#reader-container .controls .bottom, #reader-container .controls .bottomleft .horizontal, #reader-container .controls .bottomright .horizontal").children().length>0&&(i=!0),r.e("#reader-container .controls .right, #reader-container .controls .topright .vertical, #reader-container .controls .bottomright .vertical").children().length>0&&(a=!0),t&&(e.top+=r.e("#reader-container .controls .top").getHeight()),n&&(e.left+=r.e("#reader-container .controls .left").getWidth()),i&&(e.bottom-=r.e("#reader-container .controls .bottom").getHeight()),a&&(e.right-=r.e("#reader-container .controls .right").getWidth()),r.reader.overview.isOpen&&("top"==r.reader.settings.overview_direction?e.top+=r.reader.settings.overview_size:"bottom"==r.reader.settings.overview_direction?e.bottom-=r.reader.settings.overview_size:"right"==r.reader.settings.overview_direction?e.right-=r.reader.settings.overview_size:"left"==r.reader.settings.overview_direction&&(e.left+=r.reader.settings.overview_size)),e},prepare:function(){var e=r.overlays,t=r.pager.constant;if(r.pager.touchBlocked=!1,e.container.children().remove(),e.container.setStyle("padding",r.pager.current_padding+"px"),r.pager.current_mode==t.SINGLE){var n=r.pager.getPageSize(r.pager.current_page);r.e("<div>",{class:"page",width:n.width+"px",height:n.height+"px"}).appendTo(e.container)}else if(r.pager.current_mode==t.DOUBLE){var a=r.pager.getPageSize(r.pager.current_page_left),i=r.pager.getPageSize(r.pager.current_page_right);r.e("<div>",{class:"page left",width:a.width+"px",height:a.height+"px"}).appendTo(e.container),r.e("<div>",{class:"page right",width:i.width+"px",height:i.height+"px"}).appendTo(e.container)}},make_audio_controls:function(e){var t=e[0],n=r.e("<div>",{class:"controller flex horizontal"}),a=!1,i=r.e("<div>",{class:"icon",html:"play_arrow"}).appendTo(n);r.reader.make_slider({dark:!0,discrete:!0,min:0,max:100,value:50,sigfigs:0,callback:function(e){try{t.volume=e/100}catch(e){}}}).appendTo(n);i.on("click tap",(function(){if(a){i.setHtml("play_arrow");try{t.pause()}catch(e){}a=!1}else{i.setHtml("pause");try{t.play()}catch(e){r.reader.makeMessage(r.locale.getString("ERROR_TITLE"),r.locale.getString("UNSUPPORTED_AUDIO")).appendTo(r.reader.container)}a=!0}}));try{t.volume=.5}catch(e){}return n.extend({close:function(){i.setHtml("play_arrow");try{t.pause(),a=!1}catch(e){}}}),n},make_video_controls:function(e,t){var n=r.random.guid();r.e(e.getParents()[0]).setAttr("id",n);var a=e[0],i=r.e("<div>",{class:"controller flex horizontal"}),o=!1,s=r.e("<div>",{class:"icon",html:"play_arrow"}).appendTo(i),l=r.reader.make_slider({dark:!0,discrete:!1,buffering:!0,buffer:0,min:0,max:100,value:1,callback:function(e,t){h&&h.player.onSeek(e,t)}},n).appendTo(i),d=r.e("<div>",{class:"icon",html:"volume_up"}).appendTo(i),c=r.e("<div>",{class:"hidden_menu flex vertical"}).appendTo(i),g=r.e("<div>",{class:"icon",html:"fullscreen"}).appendTo(i),h=(r.reader.make_slider({dark:!0,discrete:!0,vertical:!0,min:0,max:100,value:50,sigfigs:0,callback:function(e){try{a.volume=e/100}catch(e){}}},n).appendTo(c),{player:{playpause:function(){o?h.player.pause():h.player.play()},pause:function(){try{a.pause()}catch(e){}o=!1},play:function(){try{a.play()}catch(e){r.reader.makeMessage(r.locale.getString("ERROR_TITLE"),r.locale.getString("UNSUPPORTED_VIDEO")).appendTo(r.reader.container)}},onTime:function(){l.slider.value=a.currentTime,l.slider.max=a.duration,l.slider.update(!0)},onSeek:function(e,t){if(t)try{a.currentTime=e}catch(e){}},onProgress:function(e){a.buffered.length>0&&l.slider.setBuffer(r.math.Percentage.XofY(a.buffered.end(0),a.duration))},onState:function(){a.paused?(s.setHtml("play_arrow"),o=!1):(s.setHtml("pause"),o=!0)},onMeta:function(){t&&r.is.function(t)&&t()},onFullscreen:function(e,t){r.e(t).getAttr("id")==n&&("exit"==e?g.setHtml("fullscreen_enter"):g.setHtml("fullscreen_exit"))}}});e.on("timeupdate",h.player.onTime),e.on("progress",h.player.onProgress),e.on("loadedmetadata",h.player.onMeta),e.on("pause play ended abort",h.player.onState),g.on("click tap",(function(){r.fullscreen.isFullscreen?r.fullscreen.exit():r.fullscreen.enter(e.getParents()[0])})),r.subscribe("fullscreen",h.player.onFullscreen),d.on("mouseenter",(function(){c.toggleClass("open")})),c.on("mouseleave",(function(){c.removeClass("open")})),s.on("click tap",h.player.playpause);try{a.volume=.5}catch(e){}return i.extend(h),i},make_iframe_controls:function(e){var t=e[0],n=r.e("<div>",{class:"navigator flex horizontal"});r.e("<div>").appendTo(n),r.e("<div>",{class:"icon",html:"arrow_back"}).appendTo(n),r.e("<div>",{class:"icon",html:"arrow_forward"}).appendTo(n),r.e("<div>",{class:"icon",html:"refresh"}).appendTo(n);return t.readystatechange=function(e){},n},make_gallery:function(e){for(var t=r.random.guid(),n=r.e("<div>",{class:"container",id:t}),a=r.e("<div>",{class:"navigation icon left",html:"keyboard_arrow_left"}).appendTo(n),i=r.e("<div>",{class:"navigation icon right",html:"keyboard_arrow_right"}).appendTo(n),o=r.e("<div>",{class:"fullscreen icon",html:"fullscreen_enter"}).appendTo(n),s=r.e("<div>",{class:"dots"}).appendTo(n),l=[],d=[],c=0;c<e.length;c++)l.push(r.reader.stageLoader().appendTo(n)),d.push(r.e("<div>",{class:"dot"}).appendTo(s));var g={gallery:{hasBeenStarted:!1,index:0,max:e.length-1,start:function(){if(!g.gallery.hasBeenStarted){g.gallery.hasBeenStarted=!0;for(var t=0;t<e.length;t++){var r=e[t];l[t].load([r])}l[0].addClass("appear"),d[0].addClass("active")}},next:function(){var e=g.gallery,t=e.index+1;t>e.max&&(t=0),r.e(l).removeClass("vanish appear left right"),l[e.index].addClass("vanish"),l[t].addClass("appear right"),e.index=t,r.e(d).removeClass("active"),d[e.index].addClass("active")},prev:function(){var e=g.gallery,t=e.index-1;t<=0&&(t=e.max),r.e(l).removeClass("vanish appear left right"),l[e.index].addClass("vanish"),l[t].addClass("appear left"),e.index=t,r.e(d).removeClass("active"),d[e.index].addClass("active")},onFullscreen:function(e,n){r.e(n).getAttr("id")==t&&("exit"==e?o.setHtml("fullscreen_enter"):o.setHtml("fullscreen_exit"))},fullscreen:function(){r.fullscreen.isFullscreen?r.fullscreen.exit():r.fullscreen.enter(n[0])}}};return r.TouchHandler(n,{propagate:!1,priority:!0,onSwipeLeft:g.gallery.next,onSwipeRight:g.gallery.prev}),r.subscribe("fullscreen",g.gallery.onFullscreen),a.on("click tap",g.gallery.prev),i.on("click tap",g.gallery.next),o.on("click tap",g.gallery.fullscreen),n.extend(g),n},make:function(e){var n=r.e("<div>",{class:"overlay visible "+e.type}),a=r.pager.current_zoom,i=(r.e("<div>",{class:"dimmer"}).appendTo(n),r.e("<div>",{class:"icon"}).appendTo(n)),o=r.e("<div>",{class:"controls flex horizontal reverse"}).appendTo(n),s=r.e("<div>",{class:"content"}).appendTo(n),l=r.e("<div>",{class:"wrap"}).appendTo(s),d=!1,c=!1,g=r.e("<div>",{class:"icon close",html:"close"}).appendTo(o);switch("area"==e.display?(n.addClass("area"),n.setStyle("width",e.width*a+"px"),n.setStyle("height",e.height*a+"px")):n.addClass("pin"),n.setStyle("left",e.x*a+"px"),n.setStyle("top",e.y*a+"px"),e.type){case"html":i.setHtml("code");break;case"image":i.setHtml("image");break;case"gallery":i.setHtml("photo_library");break;case"video":i.setHtml("video_library");break;case"audio":i.setHtml("library_music");break;case"link":i.setHtml("link");break;case"page":i.setHtml("input");break;case"embed":i.setHtml("web")}switch(e.icon&&i.setHtml(e.icon),e.type){case"html":l.setHtml(e.html);break;case"image":var h=r.e(e.html);r.e("<img>",{src:h.getAttr("src"),alt:r.locale.getString("IMG_ALT")}).appendTo(l),d=!0;break;case"gallery":var p=r.e(e.html),u=[];p.each((function(){u.push(r.e(this).getAttr("src"))}));var f=r.overlays.make_gallery(u).appendTo(l);e.openWidth=isNaN(e.openWidth)?1e4:e.openWidth,e.openHeight=isNaN(e.openHeight)?1e4:e.openHeight;break;case"audio":var m=r.e("<audio>"),_=(p=r.e(e.html).appendTo(m),r.overlays.make_audio_controls(m));m.appendTo(l),_.appendTo(l);break;case"video":var v=r.e("<div>",{class:"player"}),w=(r.e("<div>",{class:"shield"}).appendTo(v),r.e("<video>").appendTo(v));p=r.e(e.html).appendTo(w),_=r.overlays.make_video_controls(w,(function(){e.openWidth=isNaN(e.openWidth)?Math.max(320,w[0].videoWidth):e.openWidth,e.openHeight=isNaN(e.openHeight)?Math.max(240,w[0].videoHeight):e.openHeight,C.adjustSize(e.openWidth,e.openHeight)}));v.appendTo(l),_.appendTo(v),e.openWidth=isNaN(e.openWidth)?Math.max(320,w[0].videoWidth):e.openWidth,e.openHeight=isNaN(e.openHeight)?Math.max(240,w[0].videoHeight):e.openHeight,r.reader.container.on("keyup",(function(e){!n.hasClass("open")||32!=e.keyCode&&75!=e.keyCode||(e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),_.player.playpause())}));break;case"link":case"page":var b=(h=r.e(e.html)).getAttr("src");break;case"embed":b=(h=r.e(e.html)).getAttr("src");var E=r.e("<iframe>").appendTo(l);e.openWidth=isNaN(e.openWidth)?1e4:e.openWidth,e.openHeight=isNaN(e.openHeight)?1e4:e.openHeight}var C={adjustSize:function(t,i){if(n.hasClass("open")){for(var o=n.getRelativeXY(".content"),s=Math.max(t+16,200),l=Math.max(i+8+32+8,80),d=r.math.rect(o.y,o.x,o.y+l,o.x+s),g=r.math.rect(o.y,o.x,o.y+l,o.x+s),h=r.overlays.getAvailableSpace(),p=e.y*a,u=e.x*a,f=0;!(h.contains(g)||(g.height>h.height&&(c=!0,g.height=h.height),g.width>h.width&&(c=!0,g.width=h.width),g.top<h.top&&g.moveTopTo(h.top),g.left<h.left&&g.moveLeftTo(h.left),g.bottom>h.bottom&&g.moveTopBy(h.bottom-g.bottom),g.right>h.right&&g.moveLeftBy(h.right-g.right),f++>10)););p+=g.top-d.top,u+=g.left-d.left,s=g.width,l=g.height,c?n.addClass("overflow"):n.removeClass("overflow"),n.setStyle("width",s+"px"),n.setStyle("height",l+"px"),n.setStyle("top",p+"px"),n.setStyle("left",u+"px")}},open:function(a){if(a&&a.preventDefault&&a.preventDefault(),a&&a.stopPropagation&&a.stopPropagation(),!n.hasClass("open"))switch(r.overlays.closeAll(),e.type){case"link":t.open(b);break;case"page":r.pager.goToPage(r.pager.current_page=parseInt(b));break;case"embed":E.getAttr("src")||E.setAttr("src",b);default:r.pager.touchBlocked=!0,"gallery"==e.type&&f.gallery.start();var i=isNaN(e.openWidth)?l.getWidth():e.openWidth,o=isNaN(e.openHeight)?l.getHeight():e.openHeight;n.addClass("open"),C.adjustSize(i,o)}},close:function(t){t&&t.preventDefault&&t.preventDefault(),t&&t.stopPropagation&&t.stopPropagation(),n.hasClass("open")&&(n.removeClass("open"),r.pager.touchBlocked=!1,"audio"==e.type&&_.close(),"video"==e.type&&_.player.pause(),"area"==e.display?(n.setStyle("width",e.width*a+"px"),n.setStyle("height",e.height*a+"px")):(n.setStyle("width",""),n.setStyle("height","")),n.setStyle("left",e.x*a+"px"),n.setStyle("top",e.y*a+"px"))},onDrag:function(e){n.hasClass("open")&&c&&(s[0].scrollLeft+=e.x,s[0].scrollTop+=e.y)}};return d&&r.TouchHandler(s,{propagate:!1,priority:!0,onDrag:C.onDrag,onWheelStart:C.onWheelStart,onWheel:C.onWheel,onWheelEnd:C.onWheelEnd}),n.on("click tap",C.open),g.on("click tap",C.close),n.extend(C),n},closeAll:function(){for(var e=0,t=r.overlays.objects.length;e<t;e++)r.overlays.objects[e].close()}},pager:{pages:null,get page_count(){return Object.keys(this.pages).length},current_script:null,current_mode:1,current_mode_manual:!1,current_renderer:1,current_renderer_manual:!1,current_zoom:1,current_autozoom:!0,current_padding:20,current_controls:!1,current_controls_floating:!1,current_animation:0,current_animator:null,holders:[],loaders:[],page_container:null,content_container:null,pages_uniform:!0,pdf_exists:!1,pdf_checked:!1,pdf_checking:!1,pdf_enabled:!1,pdf_preparing:!1,pdf_loaded:!1,pdf_loaded_load:!1,pdf_loaded_progess:!1,pdf_rendering_slow:!1,pdf_last_rendertimes:[],pdf_last_rendertime_index:0,pdf_last_rendertime_max:10,is_mobile:!1,touchBlocked:!1,get pdf_average_rendertimes(){for(var e=0,t=0,r=this.pdf_last_rendertimes.length;e<r;e++)t+=this.pdf_last_rendertimes[e];return t/r},paging_handled_by_animator:!1,push_pdf_rendertime:function(e){this.pdf_last_rendertimes[this.pdf_last_rendertime_index++]=e,this.pdf_last_rendertime_index>=this.pdf_last_rendertime_max&&(this.pdf_last_rendertime_index=0)},last_page:-1,last_page_left:-1,last_page_right:-1,last_autozoom:1,current_page:0,get current_page_firstvalid(){return this.current_page<=0?1:this.current_page>this.page_count?this.page_count:this.current_page},get current_page_left(){return this.current_page<=1?this.current_page=0:this.current_mode!=this.constant.DOUBLE&&this.current_mode!=this.constant.DOUBLE_REVERSE||this.current_page%2&&this.current_page--,this.current_page},get current_page_right(){return this.current_page_left+1},get show_page_left(){return this.showPage(this.current_page_left)},get show_page_right(){return this.showPage(this.current_page_right)},get can_go_back(){if(this.current_mode==this.constant.DOUBLE||this.current_mode==this.constant.DOUBLE_REVERSE){if(Math.min(this.current_page_left,this.current_page_right)<=1)return!1}else if(this.current_page<=1)return!1;return!0},get can_go_forward(){if(this.current_mode==this.constant.DOUBLE||this.current_mode==this.constant.DOUBLE_REVERSE){if(Math.max(this.current_page_left,this.current_page_right)>=this.page_count)return!1}else if(this.current_page>=this.page_count)return!1;return!0},showPage:function(e){return e>0&&e<=this.page_count},_lastContentContained:null,_contentContainedInvalidated:!0,get contentContained(){if(this._contentContainedInvalidated){var e={width:this.page_container.getWidth(),height:this.page_container.getHeight()},t={width:r.reader.container.getWidth(),height:r.reader.container.getHeight()};this._lastContentContained=e.width<=t.width&&e.height<=t.height,this._contentContainedInvalidated=!1}return this._lastContentContained},invalidateContentContained:function(){this._contentContainedInvalidated=!0},constant:{SINGLE:1,DOUBLE:2,SINGLE_REVERSE:3,DOUBLE_REVERSE:4,SCROLL:5,PREV_LEFT:0,PREV_RIGHT:1,CUR_LEFT:2,CUR_RIGHT:3,NEXT_LEFT:4,NEXT_RIGHT:5,PREV:0,CUR:1,NEXT:2,IMG:1,PDF:2,NONE:0,FADE:1,FLIP:2,SWIPE:3},ready_for_first_load:!1,first_load_done:!1,onFirstLoad:function(){!this.first_load_done&&this.ready_for_first_load&&(this.first_load_done=!0,r.e(".main-loader").addClass("hidden"),(r.pager.is_mobile||r.reader.settings.no_pdf)&&r.reader.setProgress(100),r.pager.setAnimation(r.pager.constant[r.reader.get("animation","flip").toUpperCase()]),r.reader.settings.slideshow_mode&&r.reader.slideshow.play())},init:function(){var e=this;if(this.page_container=r.e("#reader-container .content .pages"),this.content_container=r.e("#reader-container .content"),null!=this.pages){var t,n,a,i;this.prepareElements(),r.reader.settings.overview_start_open&&r.reader.overview.open();var o=0,s=null;r.TouchHandler(this.content_container,{propagate:!0,wheelTick:10*r.reader.settings.zoom_wheel_step,onSwipeRight:function(){r.pager.touchBlocked||r.reader.settings.enable_swiping&&!r.pager.paging_handled_by_animator&&(null==r.pager.current_animator?r.pager.goBack():r.pager.current_animator.doFullAnimationPrev())},onSwipeLeft:function(){r.pager.touchBlocked||r.reader.settings.enable_swiping&&!r.pager.paging_handled_by_animator&&(null==r.pager.current_animator?r.pager.goForward():r.pager.current_animator.doFullAnimationNext())},onDrag:function(e){r.pager.touchBlocked||r.reader.settings.enable_dragging&&(r.pager.content_container[0].scrollLeft+=e.x,r.pager.content_container[0].scrollTop+=e.y)},onDoubleTap:function(t){if(!r.pager.touchBlocked&&r.reader.settings.enable_double_tapping)if(e.current_autozoom){o=1/e.current_zoom;var n=t.y*o-e.content_container.getHeight()/2,a=t.x*o-e.content_container.getWidth()/2;e.setZoom(r.reader.settings.zoom_doubleclick),e.adjust({reload:!0,scroll:{top:n,left:a},callback:function(){r.pager.content_container[0].scrollLeft=a,r.pager.content_container[0].scrollTop=n}})}else e.current_autozoom=!0,e.adjust({reload:!0})},onWheelStart:function(o){r.pager.touchBlocked||r.reader.settings.enable_mousewheel_zoom&&(t=e.page_container.getWidth(),n=e.page_container.getHeight(),s=o,t/e.content_container.getWidth(),a=s.x+e.content_container[0].scrollLeft,i=s.y+e.content_container[0].scrollTop,e.page_container.getRelativeBoundingClientRect(),e.page_container.setStyle("transformOrigin","{0}px {1}px".format(a,i)))},onWheel:function(a,i,s){if(!r.pager.touchBlocked&&r.reader.settings.enable_mousewheel_zoom){var l=r.pager.current_zoom*i;l<("auto"==r.reader.settings.zoom_min?r.pager.last_autozoom:r.reader.settings.zoom_min)?i=("auto"==r.reader.settings.zoom_min?r.pager.last_autozoom:r.reader.settings.zoom_min)/r.pager.current_zoom:l>r.reader.settings.zoom_max&&(i=r.reader.settings.zoom_max/r.pager.current_zoom),o=i,s,e.page_container.setStyle("padding","{0}px".format(e.current_padding*(1/o))),e.page_container.setStyle("height","{0}px".format(n)),e.page_container.setStyle("width","{0}px".format(t)),e.page_container.setStyle("transform","scale({0})".format(o))}},onWheelEnd:function(){if(!r.pager.touchBlocked&&r.reader.settings.enable_mousewheel_zoom){try{var t=e.page_container.getRelativeBoundingClientRect()}catch(e){}r.pager.setZoom(r.pager.current_zoom*o);var n=Math.round(-t.top),s=Math.round(-t.left);e.current_mode==e.constant.DOUBLE&&(s-=(t.right-e.page_container.getRelativeBoundingClientRect().right)/2),r.pager.adjust({reload:!0,scroll:{top:n,left:s},callback:function(){t?(r.pager.content_container[0].scrollTop=n,r.pager.content_container[0].scrollLeft=s):(r.pager.content_container[0].scrollLeft=a*o-e.content_container.getWidth()/2-e.current_padding,r.pager.content_container[0].scrollTop=i*o-e.content_container.getHeight()/2-e.current_padding)}})}},onPinchStart:function(o){r.pager.touchBlocked||r.reader.settings.enable_pinching&&(t=e.page_container.getWidth(),n=e.page_container.getHeight(),s=o,t/e.content_container.getWidth(),a=s.x+e.content_container[0].scrollLeft,i=s.y+e.content_container[0].scrollTop,e.page_container.getRelativeBoundingClientRect(),e.page_container.setStyle("transformOrigin","{0}px {1}px".format(a,i)))},onPinch:function(a,i,s){if(!r.pager.touchBlocked&&r.reader.settings.enable_pinching){var l=r.pager.current_zoom*i;l>=r.pager.last_autozoom&&l<=r.reader.settings.zoom_max&&(o=i,s,e.page_container.setStyle("padding","{0}px".format(e.current_padding*(1/o))),e.page_container.setStyle("height","{0}px".format(n)),e.page_container.setStyle("width","{0}px".format(t)),e.page_container.setStyle("transform","scale({0})".format(o)))}},onPinchEnd:function(){if(!r.pager.touchBlocked&&r.reader.settings.enable_pinching){try{var t=e.page_container.getRelativeBoundingClientRect()}catch(e){}r.pager.setZoom(r.pager.current_zoom*o);var n=Math.round(-t.top),s=Math.round(-t.left);e.current_mode==e.constant.DOUBLE&&(s-=(t.right-e.page_container.getRelativeBoundingClientRect().right)/2),r.pager.adjust({reload:!0,scroll:{top:n,left:s},callback:function(){t?(r.pager.content_container[0].scrollTop=n,r.pager.content_container[0].scrollLeft=s):(r.pager.content_container[0].scrollLeft=a*o-e.content_container.getWidth()/2-e.current_padding,r.pager.content_container[0].scrollTop=i*o-e.content_container.getHeight()/2-e.current_padding)}})}}}),this.is_mobile=r.browser.isMobile,r.e(document).on("keyup",(function(e){37==e.keyCode&&r.reader.settings.enable_keyboard_navigation&&(null==r.pager.current_animator?r.pager.goBack():r.pager.current_animator.doFullAnimationPrev()),39==e.keyCode&&r.reader.settings.enable_keyboard_navigation&&(null==r.pager.current_animator?r.pager.goForward():r.pager.current_animator.doFullAnimationNext()),e.keyCode,e.keyCode}));var l=null;r.pager.content_container.on("resize",(function(){clearTimeout(l),l=setTimeout((function(){r.pager.invalidateContentContained(),r.pager.adjust()}),50)})),this.adjust();var d=null;for(var c in this.pages){if(null!=d&&(this.pages[c].ref_size.width!=d.width||this.pages[c].ref_size.height!=d.height)){this.pages_uniform=!1;break}d=this.pages[c].ref_size}this.ready_for_first_load=!0,this.current_page=r.reader.settings.start_page,this.goToPage(this.current_page)}},setAnimation:function(e,t){var n=r.pager,a=n.constant;switch(n.pages_uniform&&!n.is_mobile||(e=a.NONE),r.pager.page_container.removeClass("flip fade swipe"),n.current_animation){case a.FLIP:r.flip_animator.destruct();break;case a.FADE:break;case a.SWIPE:r.swipe_animator.destruct()}switch(n.current_animator=null,e){case a.FLIP:n.current_animation=a.FLIP,r.reader.settings.preload=!0,r.flip_animator.init(),r.pager.page_container.addClass("flip"),n.current_animator=r.flip_animator;break;case a.FADE:n.current_animation=a.FADE,r.reader.settings.preload=!0,r.pager.page_container.addClass("fade");break;case a.SWIPE:n.current_animation=a.SWIPE,r.reader.settings.preload=!0,r.swipe_animator.init(),r.pager.page_container.addClass("swipe"),n.current_animator=r.swipe_animator;break;default:n.current_animation=a.NONE}n.adjust({reload:!0,callback:t})},setZoom:function(e,t){var n=Math.min(r.reader.settings.zoom_max,Math.max("auto"==r.reader.settings.zoom_min?this.last_autozoom:r.reader.settings.zoom_min,e));this.current_zoom=n,r.PDFManager.scale=n,t||(this.current_autozoom=!1),this.invalidateContentContained()},adjust:function(e){var t=r.pager,n=t.constant,a=e?e.callback:null,i=!!e&&e.reload;if(!t.current_mode_manual){var o=-1;-1!=(o=r.reader.container.getWidth()>r.reader.container.getHeight()?n.DOUBLE:n.SINGLE)&&o!=t.current_mode&&(t.current_mode=o,i=!0)}if(t.current_mode==n.SINGLE&&0==t.current_page&&(t.current_page=1),!t.current_renderer_manual){var s=-1;t.is_mobile||r.reader.settings.no_pdf?s=n.IMG:!r.browser.isMobile&&t.pdf_enabled&&t.pdf_loaded?s=n.PDF:r.browser.isMobile||t.pdf_enabled||t.pdf_checking||t.pdf_preparing||t.preparePdf(),-1!=s&&s!=t.current_renderer&&(t.current_renderer=s,i=!0)}if(t.current_autozoom){var l=t.calculateAutozoom();l!=t.current_zoom&&(t.setZoom(l,!0),i=!0)}i&&(t.prepareElements(),e&&e.scroll&&(r.pager.content_container[0].scrollLeft=e.scroll.left,r.pager.content_container[0].scrollTop=e.scroll.top),t.goToPage(t.current_page,a,e))},calculateAutozoom:function(){var e=r.pager,t=e.constant,n=e.getPageSize(e.current_page_firstvalid,!0),a=r.pager.content_container.getWidth()-2*e.current_padding,i=r.pager.content_container.getHeight()-2*e.current_padding,o=a/(e.current_mode==t.DOUBLE||e.current_mode==t.DOUBLE_REVERSE?2*n.width:n.width),s=i/n.height;return e.last_autozoom=o>s?s:o,e.last_autozoom},getFileName:function(e){return e},getFullPath:function(e){return r.reader.path+"/images/"+this.getFileName(e)+".jpg"},getThumbPath:function(e){return r.reader.path+"/thumbs/"+this.getFileName(e)+".jpg"},getPDFPath:function(){return r.reader.path+"/pdf/"+this.getFileName("full")+".pdf"},getPageSize:function(e,t){return this.pages[e]?t?{width:this.pages[e].ref_size.width,height:this.pages[e].ref_size.height}:{width:this.pages[e].ref_size.width*this.current_zoom,height:this.pages[e].ref_size.height*this.current_zoom}:{width:0,height:0}},prepareElements:function(){var e,t=this.constant;if(0==this.holders.length){var n=this.getPageSize(1);for(e=0;e<6;e++){this.holders[e]=r.e("<div>",{class:"page"}).appendTo(this.page_container);var a=r.e("<div>",{class:"wrapper"}).appendTo(this.holders[e]);this.loaders[e]=r.reader.stageLoader().appendTo(a),r.e("<canvas>",{class:"loading"}).appendTo(a),this.holders[e].setAttr("style","width: {0}px; height: {1}px;".format(n.width,n.height))}}if(this.current_mode==t.SINGLE||this.current_mode==t.SINGLE_REVERSE)for(this.page_container.addClass("single").removeClass("double"),e=0;e<6;e++)this.holders[e].removeClass("previous next left right"),e==t.CUR?this.holders[e].removeClass("hidden previous next"):e==t.PREV?this.holders[e].removeClass("next").addClass("hidden previous"):e==t.NEXT?this.holders[e].removeClass("previous").addClass("hidden next"):this.holders[e].addClass("hidden").removeClass("previous next");else if(this.current_mode==t.DOUBLE||this.current_mode==t.DOUBLE_REVERSE)for(this.page_container.addClass("double").removeClass("single"),e=0;e<6;e++)e==t.CUR_LEFT||e==t.CUR_RIGHT?this.holders[e].removeClass("previous next"):e==t.PREV_LEFT||e==t.PREV_RIGHT?this.holders[e].removeClass("next").addClass("previous"):e!=t.NEXT_LEFT&&e!=t.NEXT_RIGHT||this.holders[e].removeClass("previous").addClass("next"),e==t.CUR_LEFT&&this.show_page_left||e==t.CUR_RIGHT&&this.show_page_right?this.holders[e].removeClass("hidden"):this.holders[e].addClass("hidden"),e==t.CUR_LEFT||e==t.PREV_LEFT||e==t.NEXT_LEFT?this.holders[e].addClass("left").removeClass("right"):e==t.CUR_RIGHT||e==t.PREV_RIGHT||e==t.NEXT_RIGHT?this.holders[e].addClass("right").removeClass("left"):this.holders[e].removeClass("left right")},preparePdf:function(){this.pdf_checked||this.pdf_checking||(this.pdf_checking=!0,r.net.request(this.getPDFPath(),{method:"HEAD",finished:function(e,t){r.pager.pdf_exists=e,r.pager.pdf_checked=!0,r.pager.pdf_checking=!1,e?(r.pager.pdf_preparing=!0,r.pager.preparePdfJs()):(r.pager.pdf_preparing=!1,r.reader.setProgress("error"))}}))},preparePdfJs:function(){var e=r.e("script"),t=null;e.each((function(){if(this.src.contains("magalone."))return t=this.src,!1})),null!=t&&(r.pager.current_script=t,r.pager.loadPdfJsCompat((function(){r.pager.loadPdfJsMain((function(){r.pager.pdf_preparing=!1,r.pager.pdf_enabled=!0,r.PDFManager.setOnDocumentLoadHandler(r.pager.pdfJsOnLoad),r.PDFManager.setOnDocumentProgressHandler(r.pager.pdfJsOnProgress),r.PDFManager.setOnPageLoadHandler(r.pager.pdfJsOnPage),r.PDFManager.setOnPageRenderHandler(r.pager.pdfJsOnRender),r.PDFManager.loadFile(r.pager.getPDFPath())}))})))},loadPdfJsCompat:function(e){var t=r.pager.current_script.substr(0,r.pager.current_script.lastIndexOf("/"))+"/pdfjs/compatibility"+(r.pager.current_script.contains(".min")?".min":"")+".js",n=document.createElement("script"),a=!1;n.onload=function(){a||e(),a=!0},n.setAttribute("src",t),document.getElementsByTagName("head")[0].appendChild(n)},loadPdfJsMain:function(e){var t=r.pager.current_script.substr(0,r.pager.current_script.lastIndexOf("/"))+"/pdfjs/pdf"+(r.pager.current_script.contains(".min")?".min":"")+".js",n=document.createElement("script"),a=!1;n.onload=function(){a||e(),a=!0},n.setAttribute("src",t),document.getElementsByTagName("head")[0].appendChild(n)},goBack:function(e,t){var n=r.pager,a=n.constant;switch(n.current_mode){case a.SINGLE:if(n.current_page<=1)return;n.current_page--;break;case a.SINGLE_REVERSE:break;case a.DOUBLE:if(0==n.current_page)return;n.current_page-=2;case a.DOUBLE_REVERSE:}n.goToPage(n.current_page,e,{onReady:t})},goForward:function(e,t){var n=r.pager,a=n.constant;switch(n.current_mode){case a.SINGLE:if(n.current_page>=n.page_count)return;n.current_page++;break;case a.SINGLE_REVERSE:break;case a.DOUBLE:if(n.current_page_left>=n.page_count||n.current_page_right>=n.page_count)return;n.current_page+=2;case a.DOUBLE_REVERSE:}n.goToPage(n.current_page,e,{onReady:t})},goToPage:function(e,t,n){var a=this.constant;r.reader.overview.scrollToCurrentPage(),this.renderStop(),this.current_mode==a.SINGLE||this.current_mode==a.SINGLE_REVERSE?(this.renderSingle(t,n),r.reader.settings.enable_arrows&&(this.current_page<=1?r.e(".ctrl.btn.go-back").addClass("gone"):r.e(".ctrl.btn.go-back").removeClass("gone"),this.current_page>=this.page_count?r.e(".ctrl.btn.go-fwd").addClass("gone"):r.e(".ctrl.btn.go-fwd").removeClass("gone"))):this.current_mode==a.DOUBLE&&(this.renderDouble(t,n),r.reader.settings.enable_arrows&&(0==this.current_page_left?r.e(".ctrl.btn.go-back").addClass("gone"):r.e(".ctrl.btn.go-back").removeClass("gone"),this.current_page_left==this.page_count||this.current_page_right==this.page_count?r.e(".ctrl.btn.go-fwd").addClass("gone"):r.e(".ctrl.btn.go-fwd").removeClass("gone"))),r.overlays.render()},checkAndCallback:function(e){e&&r.is.function(e)&&e()},renderStop:function(){r.PDFQueue.reset(),clearTimeout(this.renderTimeout)},renderInstance:0,renderTimeout:null,renderWaitingTime:2e3,renderSingleSelf:function(e){var t={};return t.callback=e,t.this=r.pager,t.iid=++t.this.renderInstance,t.CONST=t.this.constant,t.scrollPerformed=!1,t.cur=t.this.current_page_firstvalid,t.next=t.this.current_page_firstvalid+1,t.prev=t.this.current_page_firstvalid-1,t.pageSize=t.this.getPageSize(t.cur),t.pageSizeNext=t.this.getPageSize(t.next),t.pageSizePrev=t.this.getPageSize(t.prev),t.canvas=t.this.holders[t.CONST.CUR].find("canvas"),t.canvasNext=t.this.holders[t.CONST.NEXT].find("canvas"),t.canvasPrev=t.this.holders[t.CONST.PREV].find("canvas"),t.containerWidth=t.pageSize.width+2*t.this.current_padding,t.containerHeight=t.pageSize.height+2*t.this.current_padding,t.readjust=Math.round(t.containerHeight)!=Math.round(t.this.page_container.getHeight())||Math.round(t.containerWidth)!=Math.round(t.this.page_container.getWidth()),t},renderSingle:function(e,t){var n=r.pager.renderSingleSelf(e);if(n.readjust&&t&&t.adjusted&&(n.readjust=!1),n.readjust){n.this.page_container.setAttr("style","padding: {0}px; width: {1}px; height: {2}px;".format(n.this.current_padding,n.containerWidth,n.containerHeight)),t&&t.scroll&&0==n.scrollPerformed&&(n.scrollPerformed=!0,r.pager.content_container[0].scrollLeft=t.scroll.left,r.pager.content_container[0].scrollTop=t.scroll.top);var a=r.is.object(t)?t:{};return r.extend(a,{reload:!0,callback:e,adjusted:!0}),setTimeout((function(){r.pager.adjust(a)}),1)}var i=!1,o=!1,s=function(){i||(i=!0,n.this.ready_for_first_load&&!n.this.first_load_done&&n.this.onFirstLoad(),n.this.checkAndCallback(n.callback),setTimeout((function(){n.this.prerenderSingleClean(n)}),100))},l=function(){o||i||(o=!0,t&&t.scroll&&0==n.scrollPerformed&&(n.scrollPerformed=!0,r.pager.content_container[0].scrollLeft=t.scroll.left,r.pager.content_container[0].scrollTop=t.scroll.top),setTimeout((function(){t&&t.onReady&&r.is.function(t.onReady)&&t.onReady(),n.this.prerenderSingleDirty(n)}),100))};n.this.current_renderer==n.CONST.IMG?n.this.renderSingleImg(n,l,s,t):n.this.current_renderer==n.CONST.PDF&&(n.canvas.addClass("loading"),n.this.renderSinglePdf(n,l,s,t))},renderSingleImg:function(e,t,r,n){var a=!1,i=!1;e.this.holders[e.CONST.CUR].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSize.width,e.pageSize.height)),e.this.loaders[e.CONST.CUR].setAttr("style",""),e.this.loaders[e.CONST.CUR].load([e.this.getThumbPath(e.cur)],(function(){a||(a=!0,e.this.checkAndCallback(t),setTimeout((function(){e.this.loaders[e.CONST.CUR].load([e.this.getThumbPath(e.cur),e.this.getFullPath(e.cur)],(function(){i||(i=!0,e.this.checkAndCallback(r))}))}),1))}),!0)},renderSinglePdf:function(e,t,n,a){var i=!1,o=!1;e.this.loaders[e.CONST.CUR].setAttr("style",""),e.this.loaders[e.CONST.CUR].load([e.this.getFullPath(e.cur)],(function(){e.this.holders[e.CONST.CUR].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSize.width,e.pageSize.height)),i||(i=!0,e.this.checkAndCallback(t),e.this.checkAndCallback(n),e.this.renderTimeout=setTimeout((function(){r.PDFQueue.push(e.canvas,e.cur,(function(){o||(o=!0,e.canvas.removeClass("loading"))})),r.PDFQueue.start()}),e.this.renderWaitingTime))}),!0)},prerenderSingleDirty:function(e,t){e.this.holders[e.CONST.NEXT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizeNext.width,e.pageSizeNext.height)),e.this.holders[e.CONST.PREV].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizePrev.width,e.pageSizePrev.height)),r.e([e.canvasNext,e.canvasPrev]).addClass("loading");var n=0,a=e.this.showPage(e.next)+e.this.showPage(e.prev),i=function(){++n==a&&e.this.checkAndCallback(t)};e.this.showPage(e.next)&&e.this.loaders[e.CONST.NEXT].load([e.this.getThumbPath(e.next)],i),e.this.showPage(e.prev)&&e.this.loaders[e.CONST.PREV].load([e.this.getThumbPath(e.prev)],i)},prerenderSingleClean:function(e,t){e.this.holders[e.CONST.NEXT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizeNext.width,e.pageSizeNext.height)),e.this.holders[e.CONST.PREV].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizePrev.width,e.pageSizePrev.height)),r.e([e.canvasNext,e.canvasPrev]).addClass("loading");var n=0,a=e.this.showPage(e.next)+e.this.showPage(e.prev),i=function(){++n==a&&e.this.checkAndCallback(t)};e.this.showPage(e.next)&&e.this.loaders[e.CONST.NEXT].load([e.this.getThumbPath(e.next),e.this.getFullPath(e.next)],i),e.this.showPage(e.prev)&&e.this.loaders[e.CONST.PREV].load([e.this.getThumbPath(e.prev),e.this.getFullPath(e.prev)],i)},renderDoubleSelf:function(e){var t={};return t.callback=e,t.this=r.pager,t.iid=++t.this.renderInstance,t.CONST=t.this.constant,t.scrollPerformed=!1,t.pageSizeLeft=t.this.getPageSize(t.this.current_page_left),t.pageSizeRight=t.this.getPageSize(t.this.current_page_right),t.pageSizePrevLeft=t.this.getPageSize(t.this.current_page_left-2),t.pageSizePrevRight=t.this.getPageSize(t.this.current_page_right-2),t.pageSizeNextLeft=t.this.getPageSize(t.this.current_page_left+2),t.pageSizeNextRight=t.this.getPageSize(t.this.current_page_right+2),t.canvasLeft=t.this.holders[t.CONST.CUR_LEFT].find("canvas"),t.canvasRight=t.this.holders[t.CONST.CUR_RIGHT].find("canvas"),t.canvasNextLeft=t.this.holders[t.CONST.NEXT_LEFT].find("canvas"),t.canvasNextRight=t.this.holders[t.CONST.NEXT_RIGHT].find("canvas"),t.canvasPrevLeft=t.this.holders[t.CONST.PREV_LEFT].find("canvas"),t.canvasPrevRight=t.this.holders[t.CONST.PREV_RIGHT].find("canvas"),t.left=t.this.current_page_left,t.right=t.this.current_page_right,t.nextLeft=t.this.current_page_left+2,t.nextRight=t.this.current_page_right+2,t.prevLeft=t.this.current_page_left-2,t.prevRight=t.this.current_page_right-2,t.containerWidth=(t.pageSizeLeft.width>t.pageSizeRight.width?2*t.pageSizeLeft.width:2*t.pageSizeRight.width)+2*t.this.current_padding,t.containerHeight=(t.pageSizeLeft.height>t.pageSizeRight.height?t.pageSizeLeft.height:t.pageSizeRight.height)+2*t.this.current_padding,t.readjust=Math.round(t.containerHeight)!=Math.round(t.this.page_container.getHeight())||Math.round(t.containerWidth)!=Math.round(t.this.page_container.getWidth()),t},renderDouble:function(e,t){var n=r.pager.renderDoubleSelf(e);if(n.readjust&&t&&t.adjusted&&(n.readjust=!1),n.readjust){n.this.page_container.setAttr("style","padding: {0}px; width: {1}px; height: {2}px;".format(n.this.current_padding,n.containerWidth,n.containerHeight)),t&&t.scroll&&0==n.scrollPerformed&&(n.scrollPerformed=!0,r.pager.content_container[0].scrollLeft=t.scroll.left,r.pager.content_container[0].scrollTop=t.scroll.top);var a=r.is.object(t)?t:{};return r.extend(a,{reload:!0,callback:e,adjusted:!0}),setTimeout((function(){r.pager.adjust(a)}),1)}var i=!1,o=!1,s=function(){i||(i=!0,n.this.ready_for_first_load&&!n.this.first_load_done&&n.this.onFirstLoad(),n.this.checkAndCallback(n.callback),setTimeout((function(){n.this.prerenderDoubleClean(n)}),100))},l=function(){o||i||(o=!0,t&&t.scroll&&0==n.scrollPerformed&&(n.scrollPerformed=!0,r.pager.content_container[0].scrollLeft=t.scroll.left,r.pager.content_container[0].scrollTop=t.scroll.top),setTimeout((function(){t&&t.onReady&&r.is.function(t.onReady)&&t.onReady(),n.this.prerenderDoubleDirty(n)}),100))};n.this.current_renderer==n.CONST.IMG?n.this.renderDoubleImg(n,l,s,t):n.this.current_renderer==n.CONST.PDF&&(r.e([n.canvasLeft,n.canvasRight,n.canvasNextLeft,n.canvasNextRight,n.canvasPrevLeft,n.canvasPrevRight]).addClass("loading"),n.this.renderDoublePdf(n,l,s,t))},renderDoubleImg:function(e,t,r,n){var a=!1,i=!1,o=e.this.showPage(e.left)+e.this.showPage(e.right),s=0,l=o,d=0,c=function(){++s==o&&(a=!0,e.this.checkAndCallback(t))},g=function(){++d==l&&(i=!0,e.this.checkAndCallback(r))},h=function(){setTimeout((function(){e.this.show_page_left&&e.this.loaders[e.CONST.CUR_LEFT].load([e.this.getThumbPath(e.left),e.this.getFullPath(e.left)],(function(){i||g()})),e.this.show_page_right&&e.this.loaders[e.CONST.CUR_RIGHT].load([e.this.getThumbPath(e.right),e.this.getFullPath(e.right)],(function(){i||g()}))}),1)};e.this.show_page_left?(e.this.holders[e.CONST.CUR_LEFT].removeClass("hidden"),e.this.holders[e.CONST.CUR_LEFT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizeLeft.width,e.pageSizeLeft.height)),e.this.loaders[e.CONST.CUR_LEFT].setAttr("style",""),e.this.loaders[e.CONST.CUR_LEFT].load([e.this.getThumbPath(e.left)],(function(){a||(c(),a&&h())}),!0)):e.this.holders[e.CONST.CUR_LEFT].addClass("hidden"),e.this.show_page_right?(e.this.holders[e.CONST.CUR_RIGHT].removeClass("hidden"),e.this.holders[e.CONST.CUR_RIGHT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizeRight.width,e.pageSizeRight.height)),e.this.loaders[e.CONST.CUR_RIGHT].setAttr("style",""),e.this.loaders[e.CONST.CUR_RIGHT].load([e.this.getThumbPath(e.right)],(function(){a||(c(),a&&h())}),!0)):e.this.holders[e.CONST.CUR_RIGHT].addClass("hidden")},renderDoublePdf:function(e,t,n,a){var i=!1,o=!1,s=e.this.showPage(e.left)+e.this.showPage(e.right),l=s,d=0,c=0,g=function(){++d==s&&(i=!0,e.this.checkAndCallback(t),e.this.checkAndCallback(n))},h=function(){++c==l&&(o=!0)},p=function(){e.this.renderTimeout=setTimeout((function(){e.this.show_page_left&&r.PDFQueue.push(e.canvasLeft,e.left,(function(){e.canvasLeft.removeClass("loading"),o||h()})),e.this.show_page_right&&r.PDFQueue.push(e.canvasRight,e.right,(function(){e.canvasRight.removeClass("loading"),o||h()})),r.PDFQueue.start()}),e.this.renderWaitingTime)};e.this.show_page_left?(e.this.holders[e.CONST.CUR_LEFT].removeClass("hidden"),e.this.holders[e.CONST.CUR_LEFT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizeLeft.width,e.pageSizeLeft.height)),e.this.loaders[e.CONST.CUR_LEFT].setAttr("style",""),e.this.loaders[e.CONST.CUR_LEFT].load([e.this.getFullPath(e.left)],(function(){i||(g(),i&&p())}),!0)):e.this.holders[e.CONST.CUR_LEFT].addClass("hidden"),e.this.show_page_right?(e.this.holders[e.CONST.CUR_RIGHT].removeClass("hidden"),e.this.holders[e.CONST.CUR_RIGHT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizeRight.width,e.pageSizeRight.height)),e.this.loaders[e.CONST.CUR_RIGHT].setAttr("style",""),e.this.loaders[e.CONST.CUR_RIGHT].load([e.this.getFullPath(e.right)],(function(){i||(g(),i&&p())}),!0)):e.this.holders[e.CONST.CUR_RIGHT].addClass("hidden")},prerenderDoubleDirty:function(e,t){e.this.holders[e.CONST.NEXT_LEFT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizeNextLeft.width,e.pageSizeNextLeft.height)),e.this.holders[e.CONST.NEXT_RIGHT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizeNextRight.width,e.pageSizeNextRight.height)),e.this.holders[e.CONST.PREV_LEFT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizePrevLeft.width,e.pageSizePrevLeft.height)),e.this.holders[e.CONST.PREV_RIGHT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizePrevRight.width,e.pageSizePrevRight.height)),r.e([e.canvasNextLeft,e.canvasNextRight,e.canvasPrevLeft,e.canvasPrevRight]).addClass("loading");var n=0,a=e.this.showPage(e.nextLeft)+e.this.showPage(e.nextRight)+e.this.showPage(e.prevLeft)+e.this.showPage(e.prevRight),i=function(){++n==a&&e.this.checkAndCallback(t)};e.this.showPage(e.nextLeft)&&e.this.loaders[e.CONST.NEXT_LEFT].load([e.this.getThumbPath(e.nextLeft)],i),e.this.showPage(e.nextRight)&&e.this.loaders[e.CONST.NEXT_RIGHT].load([e.this.getThumbPath(e.nextRight)],i),e.this.showPage(e.prevLeft)&&e.this.loaders[e.CONST.PREV_LEFT].load([e.this.getThumbPath(e.prevLeft)],i),e.this.showPage(e.prevRight)&&e.this.loaders[e.CONST.PREV_RIGHT].load([e.this.getThumbPath(e.prevRight)],i)},prerenderDoubleClean:function(e,t){e.this.holders[e.CONST.NEXT_LEFT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizeNextLeft.width,e.pageSizeNextLeft.height)),e.this.holders[e.CONST.NEXT_RIGHT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizeNextRight.width,e.pageSizeNextRight.height)),e.this.holders[e.CONST.PREV_LEFT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizePrevLeft.width,e.pageSizePrevLeft.height)),e.this.holders[e.CONST.PREV_RIGHT].setAttr("style","width: {0}px; height: {1}px;".format(e.pageSizePrevRight.width,e.pageSizePrevRight.height)),r.e([e.canvasNextLeft,e.canvasNextRight,e.canvasPrevLeft,e.canvasPrevRight]).addClass("loading");var n=0,a=e.this.showPage(e.nextLeft)+e.this.showPage(e.nextRight)+e.this.showPage(e.prevLeft)+e.this.showPage(e.prevRight),i=function(){++n==a&&e.this.checkAndCallback(t)};e.this.showPage(e.nextLeft)&&e.this.loaders[e.CONST.NEXT_LEFT].load([e.this.getThumbPath(e.nextLeft),e.this.getFullPath(e.nextLeft)],i),e.this.showPage(e.nextRight)&&e.this.loaders[e.CONST.NEXT_RIGHT].load([e.this.getThumbPath(e.nextRight),e.this.getFullPath(e.nextRight)],i),e.this.showPage(e.prevLeft)&&e.this.loaders[e.CONST.PREV_LEFT].load([e.this.getThumbPath(e.prevLeft),e.this.getFullPath(e.prevLeft)],i),e.this.showPage(e.prevRight)&&e.this.loaders[e.CONST.PREV_RIGHT].load([e.this.getThumbPath(e.prevRight),e.this.getFullPath(e.prevRight)],i)},pdfJsOnLoad:function(e){r.pager.pdf_loaded_load=!0,r.pager.pdf_loaded=r.pager.pdf_loaded_load&&r.pager.pdf_loaded_progess,r.pager.pdf_loaded&&r.pager.adjust()},pdfJsOnProgress:function(e){var t=r.math.Percentage.XofY(e.loaded,e.total);r.reader.setProgress(t),t>=100&&(r.pager.pdf_loaded_progess=!0,r.pager.pdf_loaded=r.pager.pdf_loaded_load&&r.pager.pdf_loaded_progess,r.pager.pdf_loaded&&r.pager.adjust())},pdfJsOnPage:function(e){},pdfJsOnRender:function(e){}},TouchHandler:function(e,t){var n,a,i,o,s,l,d,c,g,h,p,u,f,m,_,v,w=t.swipeThreshold||125,b=(t.moveThreshold,t.swipeCancel||70),E=t.doubleTapCancel||200,C=t.wheelCancel||500,S=t.wheelTick||1,R=S;f=h=c=g=_=!1;var P=r.e(e),T=function(e){return e<0?-1:1},y=function(){return P[0].scrollHeight<=P.getHeight()||P[0].scrollWidth<=P.getWidth()},x=function(e){var t=P.getPageXY();if(!e.type.startsWith("touch"))return{x:e.pageX-t.x,y:e.pageY-t.y};if(1==e.touches.length)return{x:e.touches[0].pageX-t.x,y:e.touches[0].pageY-t.y};if(2==e.touches.length){var n={x:e.touches[0].pageX-t.x,y:e.touches[0].pageY-t.y},a={x:e.touches[1].pageX-t.x,y:e.touches[1].pageY-t.y},i=r.math.Midpoint2D(n,a);return{x:i.x,y:i.y,dist:r.math.Dist2D(n,a)}}},L=function(){_&&(t.onWheelEnd&&r.is.function(t.onWheelEnd)&&t.onWheelEnd(n),_=!1)};P.on("wheel",(function(e){if(e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),!h&&!c){_||(_=!0,n=x(e),R=10,t.onWheelStart&&r.is.function(t.onWheelStart)&&t.onWheelStart(n)),R+=S*-T(e.deltaY);var a=x(e),i=S*T(e.deltaY),o=R/10;t.onWheel&&r.is.function(t.onWheel)&&t.onWheel(i,o,a),clearTimeout(m),m=setTimeout(L,C)}})),P.on("mousedown touchstart",(function(e){r.e(e.srcElement).getParents().hasClass("ctrl")||(r.pager.content_container[0].focus(),e&&e.preventDefault&&e.preventDefault(),(o=e.type.startsWith("touch"))&&e.touches.length>=2?(h=!0,g=c=!1,n=i=x(e),t.onPinchStart&&r.is.function(t.onPinchStart)&&t.onPinchStart(n)):y()?(g=!0,n=x(e)):(c=!0,i=x(e)))})),P.on("mouseleave mouseup touchend",(function(e){e&&e.preventDefault&&e.preventDefault(),f&&(P.removeClass("speed"),f=!1),h||function(e){if("mouseleave"!=e.type){var a=r.e(e.srcElement);a.getParents().hasClass("ctrl")||(p?(p=!1,clearTimeout(u),a.getAttr("id")==v.getAttr("id")&&a.getAttr("class")==v.getAttr("class")&&t.onDoubleTap&&r.is.function(t.onDoubleTap)&&t.onDoubleTap(x(e)||i||n)):(p=!0,v=a,u=setTimeout((function(){p=!1}),E)))}}(e),y()&&g?(a=e.type.startsWith("touch")&&null!=i&&null!=i?i:x(e)||n,d=r.math.Dist2D(n,a),l=Math.abs(n.y-a.y),s=n.x>a.x?1:-1,d>w&&l<b&&(1==s?t.onSwipeLeft&&r.is.function(t.onSwipeLeft)&&t.onSwipeLeft():t.onSwipeRight&&r.is.function(t.onSwipeRight)&&t.onSwipeRight()),g=!1):h?(t.onPinchEnd&&r.is.function(t.onPinchEnd)&&t.onPinchEnd(i),h=!1):c=!1})),P.on("mousemove touchmove",(function(e){if(e&&e.preventDefault&&e.preventDefault(),f||(P.addClass("speed"),f=!0),h){var a=(l=x(e)).dist-n.dist,s=l.dist/n.dist;t.onPinch&&r.is.function(t.onPinch)&&t.onPinch(a,s,l)}else if(!y()&&c){var l=x(e);a={x:i.x-l.x,y:i.y-l.y};t.onDrag&&r.is.function(t.onDrag)&&t.onDrag(a)}!o&&y()||(i=x(e))}))},PDFQueue:{queue:[],current_callback:null,runnning:!1,qid:0,push:function(e,t,n,a){this.queue.push({canvas:e,page:t,callback:n,prerender:a||!1,qid:r.PDFQueue.qid})},reset:function(){this.qid++,this.queue=[]},start:function(e){this.current_callback=e,this.runnning||(this.runnning=!0,this._render())},_render:function(){var e=r.PDFQueue,t=e.queue.pop(),n=(r.pager.constant,(new Date).getTime());if(t)if(t.qid==r.PDFQueue.qid)try{r.PDFManager.renderPageOn(t.page,r.reader.render_canvas,(function(){if(r.pager.push_pdf_rendertime((new Date).getTime()-n),t.qid==r.PDFQueue.qid){var a=t.canvas[0].getContext("2d");t.canvas[0].width=r.reader.render_canvas[0].width,t.canvas[0].height=r.reader.render_canvas[0].height,a.drawImage(r.reader.render_canvas[0],0,0),t.callback&&r.is.function(t.callback)&&t.callback()}e._render()}))}catch(t){e._render()}else e._render();else e.runnning=!1,e.current_callback&&r.is.function(e.current_callback)&&e.current_callback()}},PDFManager:{DEBUG_SYMBOL:"PDFM",document:null,pages:{},scale:1,ref_factor:-1,_rendering:!1,_loading:0,get isRendering(){return this._rendering},get isLoading(){return this._loading>0},loadFile:function(e,t){this._loading++,PDFJS.getDocument(e,null,null,this.onDocumentProgress).then((function(e){t&&r.is.function(t)&&t(e),r.PDFManager.onDocumentLoad(e)}))},getPage:function(e,t){this.pages.hasOwnProperty(e)?t&&r.is.function(t)&&t(this.pages[e]):null!=this.document&&this.document.getPage(parseInt(e)).then((function(e){t&&r.is.function(t)&&t(e),r.PDFManager.onPageLoad(e)}),(function(r){console.error("GetPageChainException",r,r.stack,"for page",e,"Callback on:",t)})).then(null,(function(r){console.error("GetPageUncaughtException",r,r.stack,"for page",e,"Callback on:",t)}))},renderPageOn:function(e,t,n,a){if(0!=r.isExElement(t)&&1==t.length)if(0==e||e>this.document.numPages)n&&r.is.function(n)&&n();else{this._rendering=!0;var i={canvasContext:t[0].getContext("2d"),viewport:null};if(this.pages.hasOwnProperty(e)){if(-1==this.ref_factor&&!0!==a){i.viewport=this.pages[e].getViewport(1);var o=r.pager.getPageSize(e,!0);this.ref_factor=o.width/i.viewport.width}else-1==this.ref_factor&&1==a&&(this.ref_factor=1);i.viewport=this.pages[e].getViewport(this.scale*this.ref_factor),t[0].width=i.viewport.width,t[0].height=i.viewport.height;try{this.pages[e].render(i).promise.then((function(e){r.PDFManager._rendering=!1,n&&r.is.function(n)&&n(e),r.PDFManager.onPageRender(e)}),(function(a){console.error("RenderPageOn_ChainException",a,a.stack,"for page",e,"on canvas",t,"callback on:",n),r.PDFManager._rendering=!1,n&&r.is.function(n)&&n(!1),r.PDFManager.onPageRender(!1)})).then(null,(function(a){console.error("RenderPageOn_UncaughtException",a,a.stack,"for page",e,"on canvas",t,"callback on:",n),r.PDFManager._rendering=!1,n&&r.is.function(n)&&n(!1),r.PDFManager.onPageRender(!1)}))}catch(a){console.error("RenderPageOn_FatalException",a,a.stack,"for page",e,"on canvas",t,"callback on:",n),r.PDFManager._rendering=!1,n&&r.is.function(n)&&n(!1),r.PDFManager.onPageRender(!1)}}else try{this.getPage(e,(function(){r.PDFManager.renderPageOn(e,t,n,a)}))}catch(t){console.error("GetPageChainException",t,t.stack,"for page",e,"Callback on:",n)}}},_handlerOnDocumentLoad:null,_handlerOnDocumentProgress:null,_handlerOnPageLoad:null,_handlerOnPageRender:null,setOnDocumentLoadHandler:function(e){e&&r.is.function(e)&&(this._handlerOnDocumentLoad=e)},setOnDocumentProgressHandler:function(e){e&&r.is.function(e)&&(this._handlerOnDocumentProgress=e)},setOnPageLoadHandler:function(e){e&&r.is.function(e)&&(this._handlerOnPageLoad=e)},setOnPageRenderHandler:function(e){e&&r.is.function(e)&&(this._handlerOnPageRender=e)},onDocumentLoad:function(e){var t=r.PDFManager;t.document=e,null!=t._handlerOnDocumentLoad&&r.is.function(t._handlerOnDocumentLoad)&&t._handlerOnDocumentLoad(e)},onDocumentProgress:function(e){var t=r.PDFManager;e&&e.loaded&&e.total&&e.loaded>=e.total&&(t._loading--,t._loading<0&&(t._loading=0)),null!=t._handlerOnDocumentProgress&&r.is.function(t._handlerOnDocumentProgress)&&t._handlerOnDocumentProgress(e)},onPageLoad:function(e){var t=r.PDFManager;t.pages[e.pageNumber]=e,null!=t._handlerOnPageLoad&&r.is.function(t._handlerOnPageLoad)&&t._handlerOnPageLoad(e)},onPageRender:function(e){var t=r.PDFManager;null!=t._handlerOnPageRender&&r.is.function(t._handlerOnPageRender)&&t._handlerOnPageRender(e)}},utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},utf8_decode:function(e){for(var t="",r=0,n=c1=c2=0;r<e.length;)(n=e.charCodeAt(r))<128?(t+=String.fromCharCode(n),r++):n>191&&n<224?(c2=e.charCodeAt(r+1),t+=String.fromCharCode((31&n)<<6|63&c2),r+=2):(c2=e.charCodeAt(r+1),c3=e.charCodeAt(r+2),t+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),r+=3);return t},sha1:function(e){var t,r,n,a,i,o,s,l,d,c=function(e,t){return e<<t|e>>>32-t},g=function(e){var t,r="";for(t=7;t>=0;t--)r+=(e>>>4*t&15).toString(16);return r},h=new Array(80),p=1732584193,u=4023233417,f=2562383102,m=271733878,_=3285377520,v=(e=this.utf8_encode(e)).length,w=[];for(r=0;r<v-3;r+=4)n=e.charCodeAt(r)<<24|e.charCodeAt(r+1)<<16|e.charCodeAt(r+2)<<8|e.charCodeAt(r+3),w.push(n);switch(v%4){case 0:r=2147483648;break;case 1:r=e.charCodeAt(v-1)<<24|8388608;break;case 2:r=e.charCodeAt(v-2)<<24|e.charCodeAt(v-1)<<16|32768;break;case 3:r=e.charCodeAt(v-3)<<24|e.charCodeAt(v-2)<<16|e.charCodeAt(v-1)<<8|128}for(w.push(r);w.length%16!=14;)w.push(0);for(w.push(v>>>29),w.push(v<<3&4294967295),t=0;t<w.length;t+=16){for(r=0;r<16;r++)h[r]=w[t+r];for(r=16;r<=79;r++)h[r]=c(h[r-3]^h[r-8]^h[r-14]^h[r-16],1);for(a=p,i=u,o=f,s=m,l=_,r=0;r<=19;r++)d=c(a,5)+(i&o|~i&s)+l+h[r]+1518500249&4294967295,l=s,s=o,o=c(i,30),i=a,a=d;for(r=20;r<=39;r++)d=c(a,5)+(i^o^s)+l+h[r]+1859775393&4294967295,l=s,s=o,o=c(i,30),i=a,a=d;for(r=40;r<=59;r++)d=c(a,5)+(i&o|i&s|o&s)+l+h[r]+2400959708&4294967295,l=s,s=o,o=c(i,30),i=a,a=d;for(r=60;r<=79;r++)d=c(a,5)+(i^o^s)+l+h[r]+3395469782&4294967295,l=s,s=o,o=c(i,30),i=a,a=d;p=p+a&4294967295,u=u+i&4294967295,f=f+o&4294967295,m=m+s&4294967295,_=_+l&4294967295}return(d=g(p)+g(u)+g(f)+g(m)+g(_)).toLowerCase()},md5:function(e){function t(e,t){return e<<t|e>>>32-t}function r(e,t){var r,n,a,i,o;return a=2147483648&e,i=2147483648&t,o=(1073741823&e)+(1073741823&t),(r=1073741824&e)&(n=1073741824&t)?2147483648^o^a^i:r|n?1073741824&o?3221225472^o^a^i:1073741824^o^a^i:o^a^i}function n(e,n,a,i,o,s,l){return e=r(e,r(r(function(e,t,r){return e&t|~e&r}(n,a,i),o),l)),r(t(e,s),n)}function a(e,n,a,i,o,s,l){return e=r(e,r(r(function(e,t,r){return e&r|t&~r}(n,a,i),o),l)),r(t(e,s),n)}function i(e,n,a,i,o,s,l){return e=r(e,r(r(function(e,t,r){return e^t^r}(n,a,i),o),l)),r(t(e,s),n)}function o(e,n,a,i,o,s,l){return e=r(e,r(r(function(e,t,r){return t^(e|~r)}(n,a,i),o),l)),r(t(e,s),n)}function s(e){var t,r="",n="";for(t=0;t<=3;t++)r+=(n="0"+(e>>>8*t&255).toString(16)).substr(n.length-2,2);return r}var l,d,c,g,h,p,u,f,m,_=Array();for(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}(e),_=function(e){for(var t,r=e.length,n=r+8,a=16*((n-n%64)/64+1),i=Array(a-1),o=0,s=0;s<r;)o=s%4*8,i[t=(s-s%4)/4]=i[t]|e.charCodeAt(s)<<o,s++;return o=s%4*8,i[t=(s-s%4)/4]=i[t]|128<<o,i[a-2]=r<<3,i[a-1]=r>>>29,i}(e),p=1732584193,u=4023233417,f=2562383102,m=271733878,l=0;l<_.length;l+=16)d=p,c=u,g=f,h=m,p=n(p,u,f,m,_[l+0],7,3614090360),m=n(m,p,u,f,_[l+1],12,3905402710),f=n(f,m,p,u,_[l+2],17,606105819),u=n(u,f,m,p,_[l+3],22,3250441966),p=n(p,u,f,m,_[l+4],7,4118548399),m=n(m,p,u,f,_[l+5],12,1200080426),f=n(f,m,p,u,_[l+6],17,2821735955),u=n(u,f,m,p,_[l+7],22,4249261313),p=n(p,u,f,m,_[l+8],7,1770035416),m=n(m,p,u,f,_[l+9],12,2336552879),f=n(f,m,p,u,_[l+10],17,4294925233),u=n(u,f,m,p,_[l+11],22,2304563134),p=n(p,u,f,m,_[l+12],7,1804603682),m=n(m,p,u,f,_[l+13],12,4254626195),f=n(f,m,p,u,_[l+14],17,2792965006),p=a(p,u=n(u,f,m,p,_[l+15],22,1236535329),f,m,_[l+1],5,4129170786),m=a(m,p,u,f,_[l+6],9,3225465664),f=a(f,m,p,u,_[l+11],14,643717713),u=a(u,f,m,p,_[l+0],20,3921069994),p=a(p,u,f,m,_[l+5],5,3593408605),m=a(m,p,u,f,_[l+10],9,38016083),f=a(f,m,p,u,_[l+15],14,3634488961),u=a(u,f,m,p,_[l+4],20,3889429448),p=a(p,u,f,m,_[l+9],5,568446438),m=a(m,p,u,f,_[l+14],9,3275163606),f=a(f,m,p,u,_[l+3],14,4107603335),u=a(u,f,m,p,_[l+8],20,1163531501),p=a(p,u,f,m,_[l+13],5,2850285829),m=a(m,p,u,f,_[l+2],9,4243563512),f=a(f,m,p,u,_[l+7],14,1735328473),p=i(p,u=a(u,f,m,p,_[l+12],20,2368359562),f,m,_[l+5],4,4294588738),m=i(m,p,u,f,_[l+8],11,2272392833),f=i(f,m,p,u,_[l+11],16,1839030562),u=i(u,f,m,p,_[l+14],23,4259657740),p=i(p,u,f,m,_[l+1],4,2763975236),m=i(m,p,u,f,_[l+4],11,1272893353),f=i(f,m,p,u,_[l+7],16,4139469664),u=i(u,f,m,p,_[l+10],23,3200236656),p=i(p,u,f,m,_[l+13],4,681279174),m=i(m,p,u,f,_[l+0],11,3936430074),f=i(f,m,p,u,_[l+3],16,3572445317),u=i(u,f,m,p,_[l+6],23,76029189),p=i(p,u,f,m,_[l+9],4,3654602809),m=i(m,p,u,f,_[l+12],11,3873151461),f=i(f,m,p,u,_[l+15],16,530742520),p=o(p,u=i(u,f,m,p,_[l+2],23,3299628645),f,m,_[l+0],6,4096336452),m=o(m,p,u,f,_[l+7],10,1126891415),f=o(f,m,p,u,_[l+14],15,2878612391),u=o(u,f,m,p,_[l+5],21,4237533241),p=o(p,u,f,m,_[l+12],6,1700485571),m=o(m,p,u,f,_[l+3],10,2399980690),f=o(f,m,p,u,_[l+10],15,4293915773),u=o(u,f,m,p,_[l+1],21,2240044497),p=o(p,u,f,m,_[l+8],6,1873313359),m=o(m,p,u,f,_[l+15],10,4264355552),f=o(f,m,p,u,_[l+6],15,2734768916),u=o(u,f,m,p,_[l+13],21,1309151649),p=o(p,u,f,m,_[l+4],6,4149444226),m=o(m,p,u,f,_[l+11],10,3174756917),f=o(f,m,p,u,_[l+2],15,718787259),u=o(u,f,m,p,_[l+9],21,3951481745),p=r(p,d),u=r(u,c),f=r(f,g),m=r(m,h);return(s(p)+s(u)+s(f)+s(m)).toLowerCase()}};exHelp.extend(n)}(window),exHelp.e(document).on("ready",(function(){exHelp.reader.init()})),function e(t){if(null==t.exHelp||null==t.exHelpExtend||null==t.exHelp.e)return setTimeout(e,100,t);var r=exHelp,n={processing:{progress_max:-1,progress_now:0,progress_page:0,progress_mode:"render",path:null,canvas:null,preview_image:null,current_script:null,elements:[{selector:".generator",options:{class:"generator"},children:[{selector:".title",options:{class:"title",html:"__LOCALE__:PROCESSING_TITLE"}},{selector:".text",options:{class:"text",html:"__LOCALE__:PROCESSING_TEXT"}},{selector:".progress",options:{class:"progress indeterminate"},children:[{selector:".bar",options:{class:"bar"}}]},{selector:".info",options:{class:"info",html:"__LOCALE__:PROCESSING_INIT"}}]}],pdf_exists:!1,pdf_checked:!1,pdf_checking:!1,pdf_enabled:!1,pdf_preparing:!1,pdf_loaded:!1,pdf_loaded_load:!1,pdf_loaded_progess:!1,data:{cover_small:null,cover_medium:null,cover_big:null,cover_retina:null,json:null,pages:null},working:!1,init:function(e){this.path=e,this.preparePdf(),r.e(".status").addClass("gone"),this.prepareElements()},prepareElements:function(){var e=r.processing;for(var t in e.elements)r.reader._prepareElement(e.elements[t],r.reader.container);var n=r.e(".content .pages");n.addClass("single");var a=r.e("<div>",{class:"page",style:"width: 100%; height: 100%;"}),i=r.e("<div>",{class:"wrapper"}).appendTo(a);e.preview_image=r.e("<img>").appendTo(i),e.canvas=r.e("<canvas>"),e.canvas.appendTo(a),a.appendTo(n)},setProgress:function(e,t){var n=r.e(".generator .progress"),a=r.e(".generator .progress .bar"),i=r.e(".generator .info");r.is.number(e)?(parseInt(e)>=0?(a.setStyle("width",e+"%"),n.removeClass("indeterminate")):(a.setStyle("width",""),n.addClass("indeterminate")),t&&i.setHtml(t)):r.is.string(e)&&i.setHtml(e)},start_processing:function(){var e=r.processing;if(!e.working){e.working=!0,e.setProgress(-1,r.locale.getString("PROCESSING_PREPARING").format(r.PDFManager.document.numPages));e.progress_max=6*r.PDFManager.document.numPages+8,e.progress_now=0,e.progress_page=0,e.progress_mode="render",r.PDFManager.scale=2,e.data={cover_small:null,cover_medium:null,cover_big:null,cover_retina:null,json:{},pages:{}},e.processing_step()}},downScaleImage:function(e,t){var r=document.createElement("canvas");return r.width=e.width,r.height=e.height,r.getContext("2d").drawImage(e,0,0),this.downScaleCanvas(r,t)},downScaleCanvas:function(e,t){if(!(t<1&&t>0))throw"scale must be a positive number <1 ";var r=t*t,n=e.width,a=e.height,i=Math.floor(n*t),o=Math.floor(a*t),s=0,l=0,d=0,c=0,g=0,h=0,p=0,u=0,f=0,m=0,_=0,v=0,w=0,b=0,E=0,C=!1,S=!1,R=e.getContext("2d").getImageData(0,0,n,a).data,P=new Float32Array(3*i*o),T=0,y=0,x=0;for(l=0;l<a;l++)for(h=3*(f=0|(g=l*t))*i,(S=f!=(0|g+t))&&(b=f+1-g,E=g+t-f-1),s=0;s<n;s++,d+=4)p=h+3*(u=0|(c=s*t)),(C=u!=(0|c+t))&&(v=u+1-c,w=c+t-u-1),T=R[d],y=R[d+1],x=R[d+2],C||S?C&&!S?(m=v*t,P[p]+=T*m,P[p+1]+=y*m,P[p+2]+=x*m,_=w*t,P[p+3]+=T*_,P[p+4]+=y*_,P[p+5]+=x*_):S&&!C?(m=b*t,P[p]+=T*m,P[p+1]+=y*m,P[p+2]+=x*m,_=E*t,P[p+3*i]+=T*_,P[p+3*i+1]+=y*_,P[p+3*i+2]+=x*_):(m=v*b,P[p]+=T*m,P[p+1]+=y*m,P[p+2]+=x*m,_=w*b,P[p+3]+=T*_,P[p+4]+=y*_,P[p+5]+=x*_,_=v*E,P[p+3*i]+=T*_,P[p+3*i+1]+=y*_,P[p+3*i+2]+=x*_,_=w*E,P[p+3*i+3]+=T*_,P[p+3*i+4]+=y*_,P[p+3*i+5]+=x*_):(P[p]+=T*r,P[p+1]+=y*r,P[p+2]+=x*r);var L=document.createElement("canvas");L.width=i,L.height=o;var O=L.getContext("2d"),D=O.getImageData(0,0,i,o),k=D.data,F=0;for(d=0,p=0;F<i*o;d+=3,p+=4,F++)k[p]=Math.ceil(P[d]),k[p+1]=Math.ceil(P[d+1]),k[p+2]=Math.ceil(P[d+2]),k[p+3]=255;return O.putImageData(D,0,0),L},resize:function(e,t){var r=t.width/e.naturalWidth;return this.downScaleImage(e,r)},processing_step:function(){var e=r.processing;console.log("Processing Step"),e.working&&("render"==e.progress_mode?e.progress_page<r.PDFManager.document.numPages?(e.progress_page++,e.processing_increment_progress(),r.PDFManager.renderPageOn(e.progress_page,e.canvas,(function(){var t=new Image;t.src=e.canvas[0].toDataURL(),t.onload=function(){e.data.pages[e.progress_page]={full:e.canvas[0].toDataURL("image/jpeg",.85),thumb:null},e.processing_increment_progress();var n={width:100,height:100*(t.naturalHeight/t.naturalWidth)};if(1==e.progress_page){e.data.cover_big=e.canvas[0].toDataURL("image/jpeg",.85),e.processing_increment_progress();var a={width:2*n.width,height:2*n.height},i={width:3*n.width,height:3*n.height};e.data.cover_retina=e.resize(t,i).toDataURL("image/jpeg",.85),e.processing_increment_progress(),e.data.cover_medium=e.resize(t,a).toDataURL("image/jpeg",.85),e.processing_increment_progress(),e.data.cover_small=e.resize(t,n).toDataURL("image/jpeg",.85),e.processing_increment_progress()}e.data.pages[e.progress_page].thumb=e.resize(t,n).toDataURL("image/jpeg",.85),e.processing_increment_progress(),r.PDFManager.getPage(e.progress_page,(function(n){n.getTextContent().then((function(n){for(var a=[],i=0;i<n.items.length;i++){var o=""+n.items[i].str.trim();o.length>0&&a.push(o)}e.data.json[e.progress_page]={page_content:r.utf8_encode(a.join(" ")),ref_size:{width:t.naturalWidth,height:t.naturalHeight}},e.processing_increment_progress(),e.processing_step()}))}))}}),!0)):(e.progress_mode="upload",e.progress_page=0,e.processing_step()):"upload"==e.progress_mode&&(e.progress_page<r.PDFManager.document.numPages?(e.progress_page++,e.processing_increment_progress_upload(),1==e.progress_page?r.net.request(e.path+"/upload.php",{method:"POST",data:{cmd:"upload",type:"page",transfer:"base64",file:e.data.pages[e.progress_page].full,page:e.progress_page},finished:function(t,n){e.processing_increment_progress_upload(),r.net.request(e.path+"/upload.php",{method:"POST",data:{cmd:"upload",type:"thumb",transfer:"base64",file:e.data.pages[e.progress_page].thumb,page:e.progress_page},finished:function(t,n){e.processing_increment_progress_upload(),r.net.request(e.path+"/upload.php",{method:"POST",data:{cmd:"upload",type:"cover_small",transfer:"base64",file:e.data.cover_small},finished:function(t,n){e.processing_increment_progress_upload(),r.net.request(e.path+"/upload.php",{method:"POST",data:{cmd:"upload",type:"cover_medium",transfer:"base64",file:e.data.cover_medium},finished:function(t,n){e.processing_increment_progress_upload(),r.net.request(e.path+"/upload.php",{method:"POST",data:{cmd:"upload",type:"cover_retina",transfer:"base64",file:e.data.cover_retina},finished:function(t,n){e.processing_increment_progress_upload(),r.net.request(e.path+"/upload.php",{method:"POST",data:{cmd:"upload",type:"cover_big",transfer:"base64",file:e.data.cover_big},finished:function(t,r){e.processing_step()}})}})}})}})}})}}):r.net.request(e.path+"/upload.php",{method:"POST",data:{cmd:"upload",type:"page",transfer:"base64",file:e.data.pages[e.progress_page].full,page:e.progress_page},finished:function(t,n){e.processing_increment_progress_upload(),r.net.request(e.path+"/upload.php",{method:"POST",data:{cmd:"upload",type:"thumb",transfer:"base64",file:e.data.pages[e.progress_page].thumb,page:e.progress_page},finished:function(t,r){e.processing_step()}})}})):r.net.request(e.path+"/upload.php",{method:"POST",data:{cmd:"upload",type:"json",transfer:"base64",file:"data:application/json;base64,"+btoa(r.jsonStringify(e.data.json))},finished:function(n,a){e.processing_increment_progress_upload(),e.setProgress(-1,"Aufrumen..."),r.net.request(e.path+"/upload.php",{method:"POST",data:{cmd:"cleanup"},finished:function(n,a){e.setProgress(100,r.locale.getString("PROCESSING_FINISHED")),t.location.reload()}})}})))},processing_increment_progress:function(){var e=r.processing;e.setProgress(r.math.Percentage.XofY(e.progress_now++,e.progress_max),r.locale.getString("PROCESSING_WORKING").format(e.progress_page,r.PDFManager.document.numPages))},processing_increment_progress_upload:function(){var e=r.processing;e.setProgress(r.math.Percentage.XofY(e.progress_now++,e.progress_max),r.locale.getString("PROCESSING_UPLOADING").format(e.progress_page,r.PDFManager.document.numPages))},preparePdf:function(){var e=r.processing;e.setProgress(-1,r.locale.getString("PROCESSING_PREP")),e.pdf_checked||e.pdf_checking||(e.pdf_checking=!0,r.net.request(e.path+"/upload.php",{method:"POST",data:{cmd:"prepare"},finished:function(t,n){t?"ok"==n.trim()?r.net.request(e.path+"/full.pdf",{method:"HEAD",finished:function(t,r){e.pdf_exists=t,e.pdf_checked=!0,e.pdf_checking=!1,t&&(e.pdf_preparing=!0,e.preparePdfJs())}}):"nopdf"==n.trim()?r.reader.makeMessage(r.locale.getString("ERROR_TITLE"),r.locale.getString("ERROR_NO_PDF")).appendTo(e.container):r.reader.makeMessage(r.locale.getString("ERROR_TITLE"),r.locale.getString("ERROR_UPLOAD_PHP")).appendTo(e.container):r.reader.makeMessage(r.locale.getString("ERROR_TITLE"),r.locale.getString("ERROR_UPLOAD_PHP")).appendTo(e.container)}}))},preparePdfJs:function(){var e=r.processing,t=r.e("script"),n=null;t.each((function(){if(this.src.contains("magalone."))return n=this.src,!1})),null!=n&&(e.current_script=n,e.loadPdfJsCompat((function(){e.loadPdfJsMain((function(){e.pdf_preparing=!1,e.pdf_enabled=!0,r.PDFManager.setOnDocumentLoadHandler(e.pdfJsOnLoad),r.PDFManager.setOnDocumentProgressHandler(e.pdfJsOnProgress),r.PDFManager.setOnPageLoadHandler(e.pdfJsOnPage),r.PDFManager.setOnPageRenderHandler(e.pdfJsOnRender),r.PDFManager.loadFile(e.path+"/full.pdf")}))})))},loadPdfJsCompat:function(e){var t=r.processing,n=t.current_script.substr(0,t.current_script.lastIndexOf("/"))+"/pdfjs/compatibility"+(t.current_script.contains(".min")?".min":"")+".js",a=document.createElement("script"),i=!1;a.onload=function(){i||e(),i=!0},a.setAttribute("src",n),document.getElementsByTagName("head")[0].appendChild(a)},loadPdfJsMain:function(e){var t=r.processing,n=t.current_script.substr(0,t.current_script.lastIndexOf("/"))+"/pdfjs/pdf"+(t.current_script.contains(".min")?".min":"")+".js",a=document.createElement("script"),i=!1;a.onload=function(){i||e(),i=!0},a.setAttribute("src",n),document.getElementsByTagName("head")[0].appendChild(a)},pdfJsOnLoad:function(e){var t=r.processing;t.pdf_loaded_load=!0,t.pdf_loaded=t.pdf_loaded_load&&t.pdf_loaded_progess,t.pdf_loaded&&t.start_processing()},pdfJsOnProgress:function(e){var t=r.processing,n=r.math.Percentage.XofY(e.loaded,e.total);t.pdf_loaded||t.setProgress(n,r.locale.getString("PROCESSING_PDF").format(n.toFixed(0))),n>=100&&(t.pdf_loaded_progess=!0,t.pdf_loaded=t.pdf_loaded_load&&t.pdf_loaded_progess,t.pdf_loaded&&t.start_processing())},pdfJsOnPage:function(e){},pdfJsOnRender:function(e){}}};exHelp.extend(n)}(window),function e(t){if(null==t.exHelp||null==t.exHelpExtend)return setTimeout(e,100,t);exHelp.storage("locale").de={ERROR_TITLE:"Fehler",ERROR_UPLOAD_PHP:"Keine upload.php Datei gefunden oder falsche Datei",ERROR_NO_FILES:"Keine Dateien gefunden",ERROR_NO_PDF:"Es wurde keine PDF Datei im Zielordner gefunden",LOADING:"Laden...",LOADING_FINISHED:"Fertig",LOADING_ERROR:"Fehler",PROCESSING_TITLE:"Inhaltvorbereitung",PROCESSING_TEXT:"Bitte warten Sie whrend Ihr Inhalt zum ersten mal Vorbereitet wird",PROCESSING_INIT:"Initialisieren...",PROCESSING_PREP:"Vorbereiten...",PROCESSING_PREPARING:"Bereite {0} Seiten vor...",PROCESSING_FINISHED:"Fertig.",PROCESSING_WORKING:"Verarbeite Seite {0} von {1}...",PROCESSING_UPLOADING:"Lade Seite {0} von {1} hoch...",PROCESSING_PDF:"Lade PDF Dokument... ({0}%)",UNSUPPORTED_AUDIO:"Ihr Browser untersttzt dieses Audioformat nicht.",UNSUPPORTED_VIDEO:"Ihr Browser untersttzt dieses Videoformat nicht."}}(window),function e(t){if(null==t.exHelp||null==t.exHelpExtend)return setTimeout(e,100,t);exHelp.storage("locale").en={ERROR_TITLE:"ERROR",ERROR_UPLOAD_PHP:"No upload.php file found or incorrect file",ERROR_NO_FILES:"No files found",ERROR_NO_PDF:"No PDF file could be found in the target directory",LOADING:"Loading...",LOADING_FINISHED:"Finished",LOADING_ERROR:"Error",PROCESSING_TITLE:"Content preparation",PROCESSING_TEXT:"Please wait while your content is being prepared for the first time",PROCESSING_INIT:"Initializing...",PROCESSING_PREP:"Preparing...",PROCESSING_PREPARING:"Preparing {0} pages...",PROCESSING_FINISHED:"Finished. Please reload the page.",PROCESSING_WORKING:"Processing page {0} of {1}...",PROCESSING_UPLOADING:"Uploading page {0} of {1}...",PROCESSING_PDF:"Loading PDF Document... ({0}%)",UNSUPPORTED_AUDIO:"Your Browser doesn't support this type of audio.",UNSUPPORTED_VIDEO:"Your Browser doesn't support this type of video."}}(window);
//# sourceMappingURL=magalone.min.js.map
